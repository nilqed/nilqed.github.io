<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Section1.7</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Section1.7</h1>
</header>
]&gt;
<a href="book-contents.xhtml">Book Contents</a><a href="section-1.6.xhtml">Previous Section 1.6 Expanding to Higher Dimensions</a><a href="section-1.8.xhtml">Next Section 1.8 Polynomials</a> <a href="book-index.xhtml">Book Index</a>
<section id="sec-1.7">
<h2 class="sectiontitle" id="writing-your-own-functions">1.7 Writing Your Own Functions</h2>
<span id="ugIntroYou" class="label"></span>
<p>FriCAS provides you with a very large library of predefined operations and objects to compute with. You can use the FriCAS library of constructors to create new objects dynamically of quite arbitrary complexity. For example, you can make lists of matrices of fractions of polynomials with complex floating point numbers as coefficients. Moreover, the library provides a wealth of operations that allow you to create and manipulate these objects.</p>
<p>For many applications, you need to interact with the interpreter and write some FriCAS programs to tackle your application. FriCAS allows you to write functions interactively, <span class="index">function</span><span id="chapter-1-61"></span> thereby effectively extending the system library. Here we give a few simple examples, leaving the details to Chapter <a href="section-6.0.xhtml#ugUser" class="ref">ugUser</a> .</p>
<p>We begin by looking at several ways that you can define the <span class="italic">factorial</span> function in FriCAS. The first way is to give a <span class="index">function:piece-wise definition</span><span id="chapter-1-62"></span> piece-wise definition of the function. <span class="index">piece-wise function definition</span><span id="chapter-1-63"></span> This method is best for a general recurrence relation since the pieces are gathered together and compiled into an efficient iterative function. Furthermore, enough previously computed values are automatically saved so that a subsequent call to the function can pick up from where it left off.</p>
Define the value of <span style="font-weight: bold;"> fact</span> at
0.
<div id="spadComm1-106" class="spadComm">
<span id="commSav1-106" class="commSav">fact(0) == 1</span>
<div id="mathAns1-106">

</div>
</div>
<div class="returnType">
Type: Void
</div>
Define the value of <span style="font-weight: bold;"> fact</span>(n) for general
n.
<div id="spadComm1-107" class="spadComm">
<span id="commSav1-107" class="commSav">fact(n) == n*fact(n-1)</span>
<div id="mathAns1-107">

</div>
</div>
<div class="returnType">
Type: Void
</div>
Ask for the value at
50. The resulting function created by FriCAS computes the value by iteration.
<div id="spadComm1-108" class="spadComm">
<span id="commSav1-108" class="commSav">fact(50)</span>
<div id="mathAns1-108">

</div>
</div>
<div class="verbatim">
<br />
   Compiling function fact with type Integer -&gt; Integer <br />
   Compiling function fact as a recurrence relation.<br />

</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>30414093201713378043612608166064768844377641568960512000000000000</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: PositiveInteger
</div>
<p>A second definition uses an <span class="teletype">if-then-else</span> and recursion.</p>
<div id="spadComm1-109" class="spadComm">
<span id="commSav1-109" class="commSav">fac(n) == if n &lt; 3 then n else n * fac(n - 1)</span>
<div id="mathAns1-109">

</div>
</div>
<div class="returnType">
Type: Void
</div>
<p>This function is less efficient than the previous version since each iteration involves a recursive function call.</p>
<div id="spadComm1-110" class="spadComm">
<span id="commSav1-110" class="commSav">fac(50)</span>
<div id="mathAns1-110">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>30414093201713378043612608166064768844377641568960512000000000000</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: PositiveInteger
</div>
<p>A third version directly uses iteration.</p>
<div id="spadComm1-111" class="spadComm">
<span id="commSav1-111" class="commSav">fa(n) == (a := 1; for i in 2..n repeat a := a*i; a)</span>
<div id="mathAns1-111">

</div>
</div>
<div class="returnType">
Type: Void
</div>
<p>This is the least space-consumptive version.</p>
<div id="spadComm1-112" class="spadComm">
<span id="commSav1-112" class="commSav">fa(50)</span>
<div id="mathAns1-112">

</div>
</div>
<div class="verbatim">
<br />
   Compiling function fac with type Integer -&gt; Integer <br />

</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>30414093201713378043612608166064768844377641568960512000000000000</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: PositiveInteger
</div>
<p>A final version appears to construct a large list and then reduces over it with multiplication.</p>
<div id="spadComm1-113" class="spadComm">
<span id="commSav1-113" class="commSav">f(n) == reduce(*,[i for i in 2..n])</span>
<div id="mathAns1-113">

</div>
</div>
<div class="returnType">
Type: Void
</div>
<p>In fact, the resulting computation is optimized into an efficient iteration loop equivalent to that of the third version.</p>
<div id="spadComm1-114" class="spadComm">
<span id="commSav1-114" class="commSav">f(50)</span>
<div id="mathAns1-114">

</div>
</div>
<div class="verbatim">
<br />
Compiling function f with type <br />
   PositiveInteger -&gt; PositiveInteger <br />

</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>30414093201713378043612608166064768844377641568960512000000000000</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: PositiveInteger
</div>
<p>The library version uses an algorithm that is different from the four above because it highly optimizes the recurrence relation definition of <span style="font-weight: bold;"> factorial</span>.</p>
<div id="spadComm1-115" class="spadComm">
<span id="commSav1-115" class="commSav">factorial(50)</span>
<div id="mathAns1-115">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>30414093201713378043612608166064768844377641568960512000000000000</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: PositiveInteger
</div>
<p>You are not limited to one-line functions in FriCAS. If you place your function definitions in <span style="font-weight: bold;"> .input</span> files <span class="index">file:input</span><span id="chapter-1-64"></span> (see <a href="section-4.1.xhtml#ugInOutIn" class="ref">ugInOutIn</a> ), you can have multi-line functions that use indentation for grouping.</p>
Given
n elements, <span style="font-weight: bold;"> diagonalMatrix</span> creates an
n by
n matrix with those elements down the diagonal. This function uses a permutation matrix that interchanges the
ith and
jth rows of a matrix by which it is right-multiplied.
<p>This function definition shows a style of definition that can be used in <span style="font-weight: bold;"> .input</span> files. Indentation is used to create <span style="font-style: italic;"> blocks</span>: sequences of expressions that are evaluated in sequence except as modified by control statements such as <span class="teletype">if-then-else</span> and <span class="teletype">return</span>.</p>
<div class="verbatim">
<br />
permMat(n, i, j) ==<br />
  m := diagonalMatrix<br />
    [(if i = k or j = k then 0 else 1)<br />
      for k in 1..n]<br />
  m(i,j) := 1<br />
  m(j,i) := 1<br />
  m<br />

</div>
<p>This creates a four by four matrix that interchanges the second and third rows.</p>
<div id="spadComm1-116" class="spadComm">
<span id="commSav1-116" class="commSav">p := permMat(4,2,3)</span>
<div id="mathAns1-116">

</div>
</div>
<div class="verbatim">
<br />
   Compiling function permMat with type (PositiveInteger,<br />
      PositiveInteger,PositiveInteger) -&gt; Matrix Integer <br />

</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[1000001001000001]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Matrix Integer
</div>
<p>Create an example matrix to permute.</p>
<div id="spadComm1-117" class="spadComm">
<span id="commSav1-117" class="commSav">m := matrix [ [4*i + j for j in 1..4] for i in 0..3]</span>
<div id="mathAns1-117">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[12345678910111213141516]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Matrix Integer
</div>
<p>Interchange the second and third rows of m.</p>
<div id="spadComm1-118" class="spadComm">
<span id="commSav1-118" class="commSav">permMat(4,2,3) * m</span>
<div id="mathAns1-118">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[12349101112567813141516]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Matrix Integer
</div>
<p>A function can also be passed as an argument to another function, which then applies the function or passes it off to some other function that does. You often have to declare the type of a function that has functional arguments.</p>
<p>This declares <span style="font-weight: bold;"> t</span> to be a two-argument function that returns a <span class="teletype">Float</span>. The first argument is a function that takes one <span class="teletype">Float</span> argument and returns a <span class="teletype">Float</span>.</p>
<div id="spadComm1-119" class="spadComm">
<span id="commSav1-119" class="commSav">t : (Float -&gt; Float, Float) -&gt; Float</span>
<div id="mathAns1-119">

</div>
</div>
<div class="returnType">
Type: Void
</div>
<p>This is the definition of <span style="font-weight: bold;"> t</span>.</p>
<div id="spadComm1-120" class="spadComm">
<span id="commSav1-120" class="commSav">t(fun, x) == fun(x)^2 + sin(x)^2</span>
<div id="mathAns1-120">

</div>
</div>
<div class="returnType">
Type: Void
</div>
<p>We have not defined a <span style="font-weight: bold;"> cos</span> in the workspace. The one from the FriCAS library will do.</p>
<div id="spadComm1-121" class="spadComm">
<span id="commSav1-121" class="commSav">t(cos, 5.2058)</span>
<div id="mathAns1-121">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1.0</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Float
</div>
<p>Here we define our own (user-defined) function.</p>
<div id="spadComm1-122" class="spadComm">
<span id="commSav1-122" class="commSav">cosinv(y) == cos(1/y)</span>
<div id="mathAns1-122">

</div>
</div>
<div class="returnType">
Type: Void
</div>
<p>Pass this function as an argument to <span style="font-weight: bold;"> t</span>.</p>
<div id="spadComm1-123" class="spadComm">
<span id="commSav1-123" class="commSav">t(cosinv, 5.2058)</span>
<div id="mathAns1-123">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1.739223724180051649254147684772932520785</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Float
</div>
FriCAS also has pattern matching capabilities for <span class="index">simplification</span><span id="chapter-1-65"></span> simplification <span class="index">pattern matching</span><span id="chapter-1-66"></span> of expressions and for defining new functions by rules. For example, suppose that you want to apply regularly a transformation that groups together products of radicals:
Note that such a transformation is not generally correct. FriCAS never uses it automatically.
<p>Give this rule the name <span style="font-weight: bold;"> groupSqrt</span>.</p>
<div id="spadComm1-124" class="spadComm">
<span id="commSav1-124" class="commSav">groupSqrt := rule(sqrt(a) * sqrt(b) == sqrt(a*b))</span>
<div id="mathAns1-124">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>%Cab==%Cab</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: RewriteRule(Integer,Integer,Expression Integer)
</div>
<p>Here is a test expression.</p>
<div id="spadComm1-125" class="spadComm">
<span id="commSav1-125" class="commSav">a := (sqrt(x) + sqrt(y) + sqrt(z))^4</span>
<div id="mathAns1-125">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>((4z+4y+12x)y+(4z+12y+4x)x)z+(12z+4y+4x)xy+z2+(6y+6x)z+y2+6xy+x2</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Expression Integer
</div>
<p>The rule <span style="font-weight: bold;"> groupSqrt</span> successfully simplifies the expression.</p>
<div id="spadComm1-126" class="spadComm">
<span id="commSav1-126" class="commSav">groupSqrt a</span>
<div id="mathAns1-126">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>(4z+4y+12x)yz+(4z+12y+4x)xz+(12z+4y+4x)xy+z2+(6y+6x)z+y2+6xy+x2</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Expression Integer
</div>
</section>
<a href="book-contents.xhtml">Book Contents</a> <a href="section-1.6.xhtml">Previous Section 1.6 Expanding to Higher Dimensions</a><a href="section-1.8.xhtml">Next Section 1.8 Polynomials</a> <a href="book-index.xhtml">Book Index</a>
</body>
</html>
