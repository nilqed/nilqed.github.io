<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Section6.18</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Section6.18</h1>
</header>
]&gt;
<a href="book-contents.xhtml">Book Contents</a><a href="section-6.17.xhtml">Previous Section 6.17 Anonymous Functions</a><a href="section-6.19.xhtml">Next Section 6.19 Example: A Famous Triangle</a> <a href="book-index.xhtml">Book Index</a>
<section id="sec-6.18">
<h2 class="sectiontitle" id="example-a-database">6.18 Example: A Database</h2>
<span id="ugUserDatabase" class="label"></span>
<p>This example shows how you can use FriCAS to organize a database of lineage data and then query the database for relationships.</p>
<p>The database is entered as <span class="italic">assertions</span> that are really pieces of a function definition.</p>
<div id="spadComm6-173" class="spadComm">
<span id="commSav6-173" class="commSav">children("albert") == ["albertJr","richard","diane"]</span>
<div id="mathAns6-173">

</div>
</div>
<div class="returnType">
Type: Void
</div>
Each piece
children(x)==y means
the children of
x are
y.
<div id="spadComm6-174" class="spadComm">
<span id="commSav6-174" class="commSav">children("richard") == ["douglas","daniel","susan"]</span>
<div id="mathAns6-174">

</div>
</div>
<div class="returnType">
Type: Void
</div>
<p>This family tree thus spans four generations.</p>
<div id="spadComm6-175" class="spadComm">
<span id="commSav6-175" class="commSav">children("douglas") == ["dougie","valerie"]</span>
<div id="mathAns6-175">

</div>
</div>
<div class="returnType">
Type: Void
</div>
<p>Say <span class="italic">no one else has children.</span></p>
<div id="spadComm6-176" class="spadComm">
<span id="commSav6-176" class="commSav">children(x) == []</span>
<div id="mathAns6-176">

</div>
</div>
<div class="returnType">
Type: Void
</div>
<p>We need some functions for computing lineage. Start with <span class="teletype">childOf</span>.</p>
<div id="spadComm6-177" class="spadComm">
<span id="commSav6-177" class="commSav">childOf(x,y) == member?(x,children(y))</span>
<div id="mathAns6-177">

</div>
</div>
<div class="returnType">
Type: Void
</div>
<p>To find the <span class="teletype">parentOf</span> someone, you have to scan the database of people applying <span class="teletype">children</span>.</p>
<div class="verbatim">
<br />
parentOf(x) ==<br />
  for y in people repeat<br />
    (if childOf(x,y) then return y)<br />
  "unknown"<br />

</div>
<div class="returnType">
Type: Void
</div>
And a grandparent of
x is just a parent of a parent of
x.
<div id="spadComm6-178" class="spadComm">
<span id="commSav6-178" class="commSav">grandParentOf(x) == parentOf parentOf x</span>
<div id="mathAns6-178">

</div>
</div>
<div class="returnType">
Type: Void
</div>
The grandchildren of
x are the people
y such that
x is a grandparent of
y.
<div id="spadComm6-179" class="spadComm">
<span id="commSav6-179" class="commSav">grandchildren(x) == [y for y in people | grandParentOf(y) = x]</span>
<div id="mathAns6-179">

</div>
</div>
<div class="returnType">
Type: Void
</div>
<p>Suppose you want to make a list of all great-grandparents. Well, a great-grandparent is a grandparent of a person who has children.</p>
<div class="verbatim">
<br />
greatGrandParents == [x for x in people |<br />
  reduce(_or,<br />
    [not empty? children(y) for y in grandchildren(x)],false)]<br />

</div>
<div class="returnType">
Type: Void
</div>
<p>Define <span class="teletype">descendants</span> to include the parent as well.</p>
<div class="verbatim">
<br />
descendants(x) ==<br />
  kids := children(x)<br />
  null kids =&gt; [x]<br />
  concat(x,reduce(concat,[descendants(y)<br />
    for y in kids],[]))<br />

</div>
<div class="returnType">
Type: Void
</div>
<p>Finally, we need a list of people. Since all people are descendants of <span class="italic">albert</span>, let's say so.</p>
<div id="spadComm6-180" class="spadComm">
<span id="commSav6-180" class="commSav">people == descendants "albert"</span>
<div id="mathAns6-180">

</div>
</div>
<div class="returnType">
Type: Void
</div>
<p>We have used <span class="italic"><span class="teletype">==</span></span> to define the database and some functions to query the database. But no computation is done until we ask for some information. Then, once and for all, the functions are analyzed and compiled to machine code for run-time efficiency. Notice that no types are given anywhere in this example. They are not needed.</p>
<p>Who are the grandchildren of <span class="italic">richard</span>?</p>
<div id="spadComm6-181" class="spadComm">
<span id="commSav6-181" class="commSav">grandchildren "richard"</span>
<div id="mathAns6-181">

</div>
</div>
<div class="verbatim">
<br />
Compiling function children with type String -&gt; List String <br />
Compiling function descendants with type String -&gt; List String <br />
Compiling body of rule people to compute value of type List String <br />
Compiling function childOf with type (String,String) -&gt; Boolean <br />
Compiling function parentOf with type String -&gt; String <br />
Compiling function grandParentOf with type String -&gt; String <br />
Compiling function grandchildren with type String -&gt; List String <br />

</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>["dougie","valerie"]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: List String
</div>
<p>Who are the great-grandparents?</p>
<div id="spadComm6-182" class="spadComm">
<span id="commSav6-182" class="commSav">greatGrandParents</span>
<div id="mathAns6-182">

</div>
</div>
<div class="verbatim">
<br />
Compiling body of rule greatGrandParents to compute value of <br />
   type List String <br />

</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>["albert"]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: List String
</div>
</section>
<a href="book-contents.xhtml">Book Contents</a> <a href="section-6.17.xhtml">Previous Section 6.17 Anonymous Functions</a><a href="section-6.19.xhtml">Next Section 6.19 Example: A Famous Triangle</a> <a href="book-index.xhtml">Book Index</a>
</body>
</html>
