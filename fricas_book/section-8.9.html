<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Section8.9</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Section8.9</h1>
</header>
]&gt;
<a href="book-contents.xhtml">Book Contents</a><a href="section-8.8.xhtml">Previous Section 8.8 Integration</a><a href="section-8.10.xhtml">Next Section 8.10 Solution of Differential Equations</a> <a href="book-index.xhtml">Book Index</a>
<section id="sec-8.9">
<h2 class="sectiontitle" id="working-with-power-series">8.9 Working with Power Series</h2>
<span id="ugProblemSeries" class="label"></span>
<p>FriCAS has very sophisticated facilities for working with power <span class="index">series</span><span id="chapter-8-115"></span> series. <span class="index">power series</span><span id="chapter-8-116"></span></p>
<p>Infinite series are represented by a list of the coefficients that have already been determined, together with a function for computing the additional coefficients if needed.</p>
<p>The system command that determines how many terms of a series is displayed is <span class="teletype">)set streams calculate</span>. For the purposes of this book, we have used this system command to display fewer than ten terms. <span class="index">set streams calculate</span><span id="chapter-8-117"></span> Series can be created from expressions, from functions for the series coefficients, and from applications of operations on existing series. The most general function for creating a series is called <span style="font-weight: bold;"> series</span>, although you can also use <span style="font-weight: bold;"> taylor</span>, <span style="font-weight: bold;"> laurent</span> and <span style="font-weight: bold;"> puiseux</span> in situations where you know what kind of exponents are involved.</p>
<p>For information about solving differential equations in terms of power series, see <a href="section-8.10.xhtml#ugxProblemDEQSeries" class="ref">ugxProblemDEQSeries</a> .</p>
<span id="subsec-8.9.1"></span>
<div id="subsec-8.9.1" class="subsection">
<h3 class="subsectitle" id="creation-of-power-series">8.9.1 Creation of Power Series</h3>
<span id="ugxProblemSeriesCreate" class="label"></span>
This is the easiest way to create a power series. This tells FriCAS that
x is to be treated as a power series, <span class="index">series:creating</span><span id="chapter-8-118"></span> so functions of
x are again power series.
<div id="spadComm8-127" class="spadComm">
<span id="commSav8-127" class="commSav">x := series 'x </span>
<div id="mathAns8-127">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
<p>We didn't say anything about the coefficients of the power series, so the coefficients are general expressions over the integers. This allows us to introduce denominators, symbolic constants, and other variables as needed.</p>
<p>Here the coefficients are integers (note that the coefficients are the Fibonacci <span class="index">Fibonacci numbers</span><span id="chapter-8-119"></span> numbers).</p>
<div id="spadComm8-128" class="spadComm">
<span id="commSav8-128" class="commSav">1/(1 - x - x^2) </span>
<div id="mathAns8-128">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1+x+2x2+3x3+5x4+8x5+13x6+21x7+34x8+55x9+89x10+O(x11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
<p>This series has coefficients that are rational numbers.</p>
<div id="spadComm8-129" class="spadComm">
<span id="commSav8-129" class="commSav">sin(x) </span>
<div id="mathAns8-129">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x-16x3+1120x5-15040x7+1362880x9-139916800x11+O(x12)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
When you enter this expression you introduce the symbolic constants
sin(1) and
cos(1).
<div id="spadComm8-130" class="spadComm">
<span id="commSav8-130" class="commSav">sin(1 + x) </span>
<div id="mathAns8-130">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>sin(1)+cos(1)x-sin(1)2x2-cos(1)6x3+sin(1)24x4+cos(1)120x5-sin(1)720x6-cos(1)5040x7+sin(1)40320x8+cos(1)362880x9-sin(1)3628800x10+O(x11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
When you enter the expression the variable
a appears in the resulting series expansion.
<div id="spadComm8-131" class="spadComm">
<span id="commSav8-131" class="commSav">sin(a * x) </span>
<div id="mathAns8-131">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>ax-a36x3+a5120x5-a75040x7+a9362880x9-a1139916800x11+O(x12)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
You can also convert an expression into a series expansion. This expression creates the series expansion of
1/log(y) about
y=1. For details and more examples, see <a href="section-8.9.xhtml#ugxProblemSeriesConversions" class="ref">ugxProblemSeriesConversions</a> .
<div id="spadComm8-132" class="spadComm">
<span id="commSav8-132" class="commSav">series(1/log(y),y = 1)</span>
<div id="mathAns8-132">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>(y-1)(-1)+12-112(y-1)+124(y-1)2-19720(y-1)3+3160(y-1)4-86360480(y-1)5+27524192(y-1)6-339533628800(y-1)7+81831036800(y-1)8-3250433479001600(y-1)9+O((y-1)10)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,y,1)
</div>
<p>You can create power series with more general coefficients. You normally accomplish this via a type declaration (see <a href="section-2.3.xhtml#ugTypesDeclare" class="ref">ugTypesDeclare</a> ). See <a href="section-8.9.xhtml#ugxProblemSeriesFunctions" class="ref">ugxProblemSeriesFunctions</a> for some warnings about working with declared series.</p>
We declare that
y is a one-variable Taylor series <span class="index">series:Taylor</span><span id="chapter-8-120"></span> (<span class="teletype">UTS</span> is the abbreviation for <span class="teletype">UnivariateTaylorSeries</span>) in the variable
z with <span class="teletype">FLOAT</span> (that is, floating-point) coefficients, centered about
0. Then, by assignment, we obtain the Taylor expansion of
exp(z) with floating-point coefficients. <span class="index">UnivariateTaylorSeries</span><span id="chapter-8-121"></span>
<div id="spadComm8-133" class="spadComm">
<span id="commSav8-133" class="commSav">y : UTS(FLOAT,'z,0) := exp(z) </span>
<div id="mathAns8-133">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1.0+z+0.5z2+0.16666666666666666667z3+0.041666666666666666667z4+0.0083333333333333333334z5+0.0013888888888888888889z6+0.0001984126984126984127z7+0.000024801587301587301587z8+0.0000027557319223985890653z9+0.27557319223985890653E-6z10+O(z11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Float,z,0.0)
</div>
You can also create a power series by giving an explicit formula for its
n-th coefficient. For details and more examples, see <a href="section-8.9.xhtml#ugxProblemSeriesFormula" class="ref">ugxProblemSeriesFormula</a> .
To create a series about
w=0 whose
n-th Taylor coefficient is
1/n!, you can evaluate this expression. This is the Taylor expansion of
exp(w) at
w=0.
<div id="spadComm8-134" class="spadComm">
<span id="commSav8-134" class="commSav">series(1/factorial(n),n,w = 0)</span>
<div id="mathAns8-134">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1+w+12w2+16w3+124w4+1120w5+1720w6+15040w7+140320w8+1362880w9+13628800w10+O(w11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,w,0)
</div>
</div>
<span id="subsec-8.9.2"></span>
<div id="subsec-8.9.2" class="subsection">
<h3 class="subsectitle" id="coefficients-of-power-series">8.9.2 Coefficients of Power Series</h3>
<span id="ugxProblemSeriesCoefficients" class="label"></span>
<p>You can extract any coefficient from a power series---even one that hasn't been computed yet. This is possible because in FriCAS, infinite series are represented by a list of the coefficients that have already been determined, together with a function for computing the additional coefficients. (This is known as <span class="italic">lazy evaluation</span>.) When you ask for a <span class="index">series:lazy evaluation</span><span id="chapter-8-122"></span> coefficient that hasn't yet been computed, FriCAS computes <span class="index">lazy evaluation</span><span id="chapter-8-123"></span> whatever additional coefficients it needs and then stores them in the representation of the power series.</p>
<p>Here's an example of how to extract the coefficients of a power series. <span class="index">series:extracting coefficients</span><span id="chapter-8-124"></span></p>
<div id="spadComm8-135" class="spadComm">
<span id="commSav8-135" class="commSav">x := series(x) </span>
<div id="mathAns8-135">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
<div id="spadComm8-136" class="spadComm">
<span id="commSav8-136" class="commSav">y := exp(x) * sin(x) </span>
<div id="mathAns8-136">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x+x2+13x3-130x5-190x6-1630x7+122680x9+1113400x10+11247400x11+O(x12)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
<p>This coefficient is readily available.</p>
<div id="spadComm8-137" class="spadComm">
<span id="commSav8-137" class="commSav">coefficient(y,6) </span>
<div id="mathAns8-137">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>-190</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Expression Integer
</div>
But let's get the fifteenth coefficient of
y.
<div id="spadComm8-138" class="spadComm">
<span id="commSav8-138" class="commSav">coefficient(y,15) </span>
<div id="mathAns8-138">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>-110216206000</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Expression Integer
</div>
If you look at
y then you see that the coefficients up to order
15 have all been computed.
<div id="spadComm8-139" class="spadComm">
<span id="commSav8-139" class="commSav">y </span>
<div id="mathAns8-139">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x+x2+13x3-130x5-190x6-1630x7+122680x9+1113400x10+11247400x11-197297200x13-1681080400x14-110216206000x15+O(x16)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
</div>
<span id="subsec-8.9.3"></span>
<div id="subsec-8.9.3" class="subsection">
<h3 class="subsectitle" id="power-series-arithmetic">8.9.3 Power Series Arithmetic</h3>
<span id="ugxProblemSeriesArithmetic" class="label"></span>
You can manipulate power series using the usual arithmetic operations <span class="index">series:arithmetic</span><span id="chapter-8-125"></span>
+,
-,
*, and
/ (from UnivariatePuiseuxSeries)
<p>The results of these operations are also power series.</p>
<div id="spadComm8-140" class="spadComm">
<span id="commSav8-140" class="commSav">x := series x </span>
<div id="mathAns8-140">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
<div id="spadComm8-141" class="spadComm">
<span id="commSav8-141" class="commSav">(3 + x) / (1 + 7*x)</span>
<div id="mathAns8-141">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>3-20x+140x2-980x3+6860x4-48020x5+336140x6-2352980x7+16470860x8-115296020x9+807072140x10+O(x11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
You can also compute
f(x)**g(x), where
f(x) and
g(x) are two power series.
<div id="spadComm8-142" class="spadComm">
<span id="commSav8-142" class="commSav">base := 1 / (1 - x) </span>
<div id="mathAns8-142">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1+x+x2+x3+x4+x5+x6+x7+x8+x9+x10+O(x11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
<div id="spadComm8-143" class="spadComm">
<span id="commSav8-143" class="commSav">expon := x * base </span>
<div id="mathAns8-143">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x+x2+x3+x4+x5+x6+x7+x8+x9+x10+x11+O(x12)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
<div id="spadComm8-144" class="spadComm">
<span id="commSav8-144" class="commSav">base ^ expon </span>
<div id="mathAns8-144">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1+x2+32x3+73x4+4312x5+649120x6+24130x7+3706315x8+857635040x9+24533910080x10+O(x11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
</div>
<span id="subsec-8.9.4"></span>
<div id="subsec-8.9.4" class="subsection">
<h3 class="subsectitle" id="functions-on-power-series">8.9.4 Functions on Power Series</h3>
<span id="ugxProblemSeriesFunctions" class="label"></span>
<p>Once you have created a power series, you can apply transcendental functions (for example, <span style="font-weight: bold;"> exp</span>, <span style="font-weight: bold;"> log</span>, <span style="font-weight: bold;"> sin</span>, <span style="font-weight: bold;"> tan</span>, <span style="font-weight: bold;"> cosh</span>, etc.) to it.</p>
<p>To demonstrate this, we first create the power series expansion of the rational function</p>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x21-6x+x2</td>
</tr>
</tbody>
</table>
</div>
about
x=0.
<div id="spadComm8-145" class="spadComm">
<span id="commSav8-145" class="commSav">x := series 'x </span>
<div id="mathAns8-145">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
<div id="spadComm8-146" class="spadComm">
<span id="commSav8-146" class="commSav">rat := x^2 / (1 - 6*x + x^2) </span>
<div id="mathAns8-146">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x2+6x3+35x4+204x5+1189x6+6930x7+40391x8+235416x9+1372105x10+7997214x11+46611179x12+O(x13)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
<p>If you want to compute the series expansion of</p>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>sin(x21-6x+x2)</td>
</tr>
</tbody>
</table>
</div>
you simply compute the sine of
rat.
<div id="spadComm8-147" class="spadComm">
<span id="commSav8-147" class="commSav">sin(rat) </span>
<div id="mathAns8-147">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x2+6x3+35x4+204x5+71336x6+6927x7+807112x8+235068x9+164285281120x10+318885134x11+3713247778x12+O(x13)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
<div class="boxed2">
<div class="boxed">
<p><span style="font-weight: bold;"> Warning:</span> the type of the coefficients of a power series may affect the kind of computations that you can do with that series. This can only happen when you have made a declaration to specify a series domain with a certain type of coefficient.<br />
</p>
</div>
</div>
If you evaluate then you have declared that
y is a one variable Taylor series <span class="index">series:Taylor</span><span id="chapter-8-126"></span> (<span class="teletype">UTS</span> is the abbreviation for <span class="teletype">UnivariateTaylorSeries</span>) in the variable
y with <span class="teletype">FRAC INT</span> (that is, fractions of integer) coefficients, centered about
0.
<div id="spadComm8-148" class="spadComm">
<span id="commSav8-148" class="commSav">y : UTS(FRAC INT,y,0) := y </span>
<div id="mathAns8-148">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>y</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Fraction Integer,y,0)
</div>
You can now compute certain power series in
y, <span class="italic">provided</span> that these series have rational coefficients.
<div id="spadComm8-149" class="spadComm">
<span id="commSav8-149" class="commSav">exp(y) </span>
<div id="mathAns8-149">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1+y+12y2+16y3+124y4+1120y5+1720y6+15040y7+140320y8+1362880y9+13628800y10+O(y11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Fraction Integer,y,0)
</div>
You can get examples of such series by applying transcendental functions to series in
y that have no constant terms.
<div id="spadComm8-150" class="spadComm">
<span id="commSav8-150" class="commSav">tan(y^2) </span>
<div id="mathAns8-150">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>y2+13y6+215y10+O(y11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Fraction Integer,y,0)
</div>
<div id="spadComm8-151" class="spadComm">
<span id="commSav8-151" class="commSav">cos(y + y^5) </span>
<div id="mathAns8-151">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1-12y2+124y4-721720y6+672140320y8-18446413628800y10+O(y11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Fraction Integer,y,0)
</div>
Similarly, you can compute the logarithm of a power series with rational coefficients if the constant coefficient is
1.
<div id="spadComm8-152" class="spadComm">
<span id="commSav8-152" class="commSav">log(1 + sin(y)) </span>
<div id="mathAns8-152">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>y-12y2+16y3-112y4+124y5-145y6+615040y7-172520y8+27772576y9-3114175y10+O(y11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Fraction Integer,y,0)
</div>
If you wanted to apply, say, the operation <span style="font-weight: bold;"> exp</span> to a power series with a nonzero constant coefficient
a0, then the constant coefficient of the result would be
ea0, which is <span class="italic">not</span> a rational number. Therefore, evaluating
exp(2+tan(y)) would generate an error message.
If you want to compute the Taylor expansion of
exp(2+tan(y)), you must ensure that the coefficient domain has an operation <span style="font-weight: bold;"> exp</span> defined for it. An example of such a domain is <span class="teletype">Expression Integer</span>, the type of formal functional expressions over the integers.
<p>When working with coefficients of this type,</p>
<div id="spadComm8-153" class="spadComm">
<span id="commSav8-153" class="commSav">z : UTS(EXPR INT,z,0) := z </span>
<div id="mathAns8-153">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>z</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Expression Integer,z,0)
</div>
<p>this presents no problems.</p>
<div id="spadComm8-154" class="spadComm">
<span id="commSav8-154" class="commSav">exp(2 + tan(z)) </span>
<div id="mathAns8-154">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>e2+e2z+e22z2+e22z3+3e28z4+37e2120z5+59e2240z6+137e2720z7+871e25760z8+41641e2362880z9+325249e23628800z10+O(z11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Expression Integer,z,0)
</div>
<p>Another way to create Taylor series whose coefficients are expressions over the integers is to use <span style="font-weight: bold;"> taylor</span> which works similarly to <span class="index">series:Taylor</span><span id="chapter-8-127"></span> <span style="font-weight: bold;"> series</span>.</p>
This is equivalent to the previous computation, except that now we are using the variable
w instead of
z.
<div id="spadComm8-155" class="spadComm">
<span id="commSav8-155" class="commSav">w := taylor 'w </span>
<div id="mathAns8-155">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>w</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Expression Integer,w,0)
</div>
<div id="spadComm8-156" class="spadComm">
<span id="commSav8-156" class="commSav">exp(2 + tan(w)) </span>
<div id="mathAns8-156">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>e2+e2w+e22w2+e22w3+3e28w4+37e2120w5+59e2240w6+137e2720w7+871e25760w8+41641e2362880w9+325249e23628800w10+O(w11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Expression Integer,w,0)
</div>
</div>
<span id="subsec-8.9.5"></span>
<div id="subsec-8.9.5" class="subsection">
<h3 class="subsectitle" id="converting-to-power-series">8.9.5 Converting to Power Series</h3>
<span id="ugxProblemSeriesConversions" class="label"></span>
<p>The <span class="teletype">ExpressionToUnivariatePowerSeries</span> package provides operations for computing series expansions of functions. <span class="index">ExpressionToUnivariatePowerSeries</span><span id="chapter-8-128"></span></p>
Evaluate this to compute the Taylor expansion of
sinx about <span class="index">series:Taylor</span><span id="chapter-8-129"></span>
x=0. The first argument,
sin(x), specifies the function whose series expansion is to be computed and the second argument,
x=0, specifies that the series is to be expanded in power of
(x-0), that is, in power of
x.
<div id="spadComm8-157" class="spadComm">
<span id="commSav8-157" class="commSav">taylor(sin(x),x = 0)</span>
<div id="mathAns8-157">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x-16x3+1120x5-15040x7+1362880x9+O(x11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Expression Integer,x,0)
</div>
Here is the Taylor expansion of
sinx about
x=π6:
<div id="spadComm8-158" class="spadComm">
<span id="commSav8-158" class="commSav">taylor(sin(x),x = %pi/6)</span>
<div id="mathAns8-158">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>12+32(x-π6)-14(x-π6)2-312(x-π6)3+148(x-π6)4+3240(x-π6)5-11440(x-π6)6-310080(x-π6)7+180640(x-π6)8+3725760(x-π6)9-17257600(x-π6)10+O((x-π6)11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Expression Integer,x,pi/6)
</div>
<p>The function to be expanded into a series may have variables other than <span class="index">series:multiple variables</span><span id="chapter-8-130"></span> the series variable.</p>
For example, we may expand
tan(x*y) as a Taylor series in
x
<div id="spadComm8-159" class="spadComm">
<span id="commSav8-159" class="commSav">taylor(tan(x*y),x = 0)</span>
<div id="mathAns8-159">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>yx+y33x3+2y515x5+17y7315x7+62y92835x9+O(x11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Expression Integer,x,0)
</div>
or as a Taylor series in
y.
<div id="spadComm8-160" class="spadComm">
<span id="commSav8-160" class="commSav">taylor(tan(x*y),y = 0)</span>
<div id="mathAns8-160">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>xy+x33y3+2x515y5+17x7315y7+62x92835y9+O(y11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Expression Integer,y,0)
</div>
A more interesting function is
textet-1 When we expand this function as a Taylor series in
t the
n-th order coefficient is the
n-th Bernoulli <span class="index">Bernoulli:polynomial</span><span id="chapter-8-131"></span> polynomial <span class="index">polynomial:Bernoulli</span><span id="chapter-8-132"></span> divided by
n!.
<div id="spadComm8-161" class="spadComm">
<span id="commSav8-161" class="commSav">bern := taylor(t*exp(x*t)/(exp(t) - 1),t = 0) </span>
<div id="mathAns8-161">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1+2x-12t+6x2-6x+112t2+2x3-3x2+x12t3+30x4-60x3+30x2-1720t4+6x5-15x4+10x3-x720t5+42x6-126x5+105x4-21x2+130240t6+6x7-21x6+21x5-7x3+x30240t7+30x8-120x7+140x6-70x4+20x2-11209600t8+10x9-45x8+60x7-42x5+20x3-3x3628800t9+66x10-330x9+495x8-462x6+330x4-99x2+5239500800t10+O(t11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Expression Integer,t,0)
</div>
<p>Therefore, this and the next expression produce the same result.</p>
<div id="spadComm8-162" class="spadComm">
<span id="commSav8-162" class="commSav">factorial(6) * coefficient(bern,6) </span>
<div id="mathAns8-162">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>42x6-126x5+105x4-21x2+142</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Expression Integer
</div>
<div id="spadComm8-163" class="spadComm">
<span id="commSav8-163" class="commSav">bernoulliB(6,x)</span>
<div id="mathAns8-163">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x6-3x5+52x4-12x2+142</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Polynomial Fraction Integer
</div>
Technically, a series with terms of negative degree is not considered to be a Taylor series, but, rather, a <span class="index">series:Laurent</span><span id="chapter-8-133"></span> <span class="italic">Laurent series</span>. <span class="index">Laurent series</span><span id="chapter-8-134"></span> If you try to compute a Taylor series expansion of
xlogx at
x=1 via
taylor(x/log(x),x=1) you get an error message. The reason is that the function has a <span class="italic">pole</span> at
x=1, meaning that its series expansion about this point has terms of negative degree. A series with finitely many terms of negative degree is called a Laurent series.
<p>You get the desired series expansion by issuing this.</p>
<div id="spadComm8-164" class="spadComm">
<span id="commSav8-164" class="commSav">laurent(x/log(x),x = 1)</span>
<div id="mathAns8-164">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>(x-1)(-1)+32+512(x-1)-124(x-1)2+11720(x-1)3-111440(x-1)4+27160480(x-1)5-134480(x-1)6+72973628800(x-1)7-425290304(x-1)8+530113479001600(x-1)9+O((x-1)10)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateLaurentSeries(Expression Integer,x,1)
</div>
Similarly, a series with terms of fractional degree is neither a Taylor series nor a Laurent series. Such a series is called a <span class="index">series:Puiseux</span><span id="chapter-8-135"></span> <span class="italic">Puiseux series</span>. <span class="index">Puiseux series</span><span id="chapter-8-136"></span> The expression
laurent(sqrt(sec(x)),x=3*%pi/2) results in an error message because the series expansion about this point has terms of fractional degree.
<p>However, this command produces what you want.</p>
<div id="spadComm8-165" class="spadComm">
<span id="commSav8-165" class="commSav">puiseux(sqrt(sec(x)),x = 3 * %pi/2)</span>
<div id="mathAns8-165">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>(x-3π2)(-12)+112(x-3π2)32+1160(x-3π2)72+O((x-3π2)5)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,(3*pi)/2)
</div>
Finally, consider the case of functions that do not have Puiseux expansions about certain points. An example of this is
xx about
x=0.
puiseux(x**x,x=0) produces an error message because of the type of singularity of the function at
x=0.
The general function <span style="font-weight: bold;"> series</span> can be used in this case. Notice that the series returned is not, strictly speaking, a power series because of the
log(x) in the expansion.
<div id="spadComm8-166" class="spadComm">
<span id="commSav8-166" class="commSav">series(x^x,x=0)</span>
<div id="mathAns8-166">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1+log(x)x+log(x)22x2+log(x)36x3+log(x)424x4+log(x)5120x5+log(x)6720x6+log(x)75040x7+log(x)840320x8+log(x)9362880x9+log(x)103628800x10+O(x11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: GeneralUnivariatePowerSeries(Expression Integer,x,0)
</div>
<div class="boxed2">
<div class="boxed">
<p>The operation <span style="font-weight: bold;"> series</span> returns the most general type of infinite series. The user who is not interested in distinguishing between various types of infinite series may wish to use this operation exclusively.<br />
</p>
</div>
</div>
</div>
<span id="subsec-8.9.6"></span>
<div id="subsec-8.9.6" class="subsection">
<h3 class="subsectitle" id="power-series-from-formulas">8.9.6 Power Series from Formulas</h3>
<span id="ugxProblemSeriesFormula" class="label"></span>
The <span class="teletype">GenerateUnivariatePowerSeries</span> package enables you to <span class="index">series:giving formula for coefficients</span><span id="chapter-8-137"></span> create power series from explicit formulas for their
n-th coefficients. In what follows, we construct series expansions for certain transcendental functions by giving formulas for their coefficients. You can also compute such series expansions directly simply by specifying the function and the point about which the series is to be expanded. <span class="index">GenerateUnivariatePowerSeries</span><span id="chapter-8-138"></span> See <a href="section-8.9.xhtml#ugxProblemSeriesConversions" class="ref">ugxProblemSeriesConversions</a> for more information.
Consider the Taylor expansion of
ex <span class="index">series:Taylor</span><span id="chapter-8-139"></span> about
x=0:
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>ex=1+x+x22+x36+···=∑n=0∞xnn!</td>
</tr>
</tbody>
</table>
</div>
The
n-th Taylor coefficient is
1/n!.
<p>This is how you create this series in FriCAS.</p>
<div id="spadComm8-167" class="spadComm">
<span id="commSav8-167" class="commSav">series(n +-&gt; 1/factorial(n),x = 0)</span>
<div id="mathAns8-167">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1+x+12x2+16x3+124x4+1120x5+1720x6+15040x7+140320x8+1362880x9+13628800x10+O(x11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
The first argument specifies a formula for the
n-th coefficient by giving a function that maps
n to
1/n!. The second argument specifies that the series is to be expanded in powers of
(x-0), that is, in powers of
x. Since we did not specify an initial degree, the first term in the series was the term of degree 0 (the constant term). Note that the formula was given as an anonymous function. These are discussed in <a href="section-6.17.xhtml#ugUserAnon" class="ref">ugUserAnon</a> .
Consider the Taylor expansion of
logx about
x=1:
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>log(x)=(x-1)-(x-1)22+(x-1)33-···=∑n=1∞(-1)n-1(x-1)nn</td>
</tr>
</tbody>
</table>
</div>
If you were to evaluate the expression
series(n+-&gt;(-1)**(n-1)/n,x=1) you would get an error message because FriCAS would try to calculate a term of degree
0 and therefore divide by
0.
Instead, evaluate this. The third argument,
1.., indicates that only terms of degree
n=1,... are to be computed.
<div id="spadComm8-168" class="spadComm">
<span id="commSav8-168" class="commSav">series(n +-&gt; (-1)^(n-1)/n,x = 1,1..)</span>
<div id="mathAns8-168">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>(x-1)-12(x-1)2+13(x-1)3-14(x-1)4+15(x-1)5-16(x-1)6+17(x-1)7-18(x-1)8+19(x-1)9-110(x-1)10+111(x-1)11+O((x-1)12)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,1)
</div>
Next consider the Taylor expansion of an odd function, say,
sin(x):
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>sin(x)=x-x33!+x55!-···</td>
</tr>
</tbody>
</table>
</div>
<p>Here every other coefficient is zero and we would like to give an explicit formula only for the odd Taylor coefficients.</p>
This is one way to do it. The third argument,
1.., specifies that the first term to be computed is the term of degree 1. The fourth argument,
2, specifies that we increment by
2 to find the degrees of subsequent terms, that is, the next term is of degree
1+2, the next of degree
1+2+2, etc.
<div id="spadComm8-169" class="spadComm">
<span id="commSav8-169" class="commSav">series(n +-&gt; (-1)^((n-1)/2)/factorial(n),x = 0,1..,2)</span>
<div id="mathAns8-169">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x-16x3+1120x5-15040x7+1362880x9-139916800x11+O(x12)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
The initial degree and the increment do not have to be integers. For example, this expression produces a series expansion of
sin(x13).
<div id="spadComm8-170" class="spadComm">
<span id="commSav8-170" class="commSav">series(n +-&gt; (-1)^((3*n-1)/2)/factorial(3*n),x = 0,1/3..,2/3)</span>
<div id="mathAns8-170">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x13-16x+1120x53-15040x73+1362880x3-139916800x113+O(x4)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
While the increment must be positive, the initial degree may be negative. This yields the Laurent expansion of
csc(x) at
x=0. (bernoulli(numer(n+1)) is necessary because bernoulli takes integer arguments.)
<div id="spadComm8-171" class="spadComm">
<span id="commSav8-171" class="commSav">cscx := series(n +-&gt; (-1)^((n-1)/2) * 2 * (2^n-1) * bernoulli(numer(n+1)) / factorial(n+1), x=0, -1..,2) </span>
<div id="mathAns8-171">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x(-1)+16x+7360x3+3115120x5+127604800x7+733421440x9+O(x10)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
Of course, the reciprocal of this power series is the Taylor expansion of
sin(x).
<div id="spadComm8-172" class="spadComm">
<span id="commSav8-172" class="commSav">1/cscx </span>
<div id="mathAns8-172">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x-16x3+1120x5-15040x7+1362880x9-139916800x11+O(x12)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
As a final example,here is the Taylor expansion of
asin(x) about
x=0.
<div id="spadComm8-173" class="spadComm">
<span id="commSav8-173" class="commSav">asinx := series(n +-&gt; binomial(n-1,(n-1)/2)/(n*2^(n-1)),x=0,1..,2) </span>
<div id="mathAns8-173">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x+16x3+340x5+5112x7+351152x9+632816x11+O(x12)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
When we compute the
sin of this series, we get
x (in the sense that all higher terms computed so far are zero).
<div id="spadComm8-174" class="spadComm">
<span id="commSav8-174" class="commSav">sin(asinx) </span>
<div id="mathAns8-174">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>x+O(x12)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariatePuiseuxSeries(Expression Integer,x,0)
</div>
<div class="boxed2">
<div class="boxed">
<p>FriCAS isn't sufficiently <span class="italic">symbolic</span> in the sense we might wish. It is an open problem to decide that <span class="italic">x</span> is the only surviving term. Two attacks on the problem might be:</p>
<p>(1) Notice that all of the higher terms are identically zero but FriCAS can't decide that from the information it knows. Presumably we could attack this problem by looking at the sin function as a taylor series around x=0 and seeing the term cancellation occur. This uses a term-difference mechanism.</p>
<p>(2) Notice that there is no way to decide that the stream for asinx is actually the definition of asin(x). But we could recognize that the stream for asin(x) has a generator term and so will a taylor series expansion of sin(x). From these two generators it may be possible in certain cases to decide that the application of one generator to the other will yield only <span class="italic">x</span>. This trick involves finding the correct inverse for the stream functions. If we can find an inverse for the <span class="italic">remaining tail</span> of the stream we could conclude cancellation and thus turn an infinite stream into a finite object.</p>
<p>In general this is the zero-equivalence problem and is undecidable.<br />
</p>
</div>
</div>
<p>As we discussed in <a href="section-8.9.xhtml#ugxProblemSeriesConversions" class="ref">ugxProblemSeriesConversions</a> , you can also use the operations <span style="font-weight: bold;"> taylor</span>, <span style="font-weight: bold;"> laurent</span> and <span style="font-weight: bold;"> puiseux</span> instead of <span style="font-weight: bold;"> series</span> if you know ahead of time what kind of exponents a series has. You can't go wrong using <span style="font-weight: bold;"> series</span>, though.</p>
</div>
<span id="subsec-8.9.7"></span>
<div id="subsec-8.9.7" class="subsection">
<h3 class="subsectitle" id="substituting-numerical-values-in-power-series">8.9.7 Substituting Numerical Values in Power Series</h3>
<span id="ugxProblemSeriesSubstitute" class="label"></span>
Use <span class="spadfunFrom">eval</span><span class="index">eval</span><span id="chapter-8-140"></span><span class="index">UnivariatePowerSeriesCategory</span><span id="chapter-8-141"></span> <span class="index">approximation</span><span id="chapter-8-142"></span> to substitute a numerical value for a variable in <span class="index">series:numerical approximation</span><span id="chapter-8-143"></span> a power series. For example, here's a way to obtain numerical approximations of
%e from the Taylor series expansion of
exp(x).
<p>First you create the desired Taylor expansion.</p>
<div id="spadComm8-175" class="spadComm">
<span id="commSav8-175" class="commSav">f := taylor(exp(x)) </span>
<div id="mathAns8-175">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1+x+12x2+16x3+124x4+1120x5+1720x6+15040x7+140320x8+1362880x9+13628800x10+O(x11)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Expression Integer,x,0)
</div>
Then you evaluate the series at the value
1.0. The result is a sequence of the partial sums.
<div id="spadComm8-176" class="spadComm">
<span id="commSav8-176" class="commSav">eval(f,1.0)</span>
<div id="mathAns8-176">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[1.0,2.0,2.5,2.6666666666666666667,2.7083333333333333333,.2.7166666666666666667,2.7180555555555555556,2.718253968253968254,.2.7182787698412698413,2.7182815255731922399,…]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Stream Expression Float
</div>
</div>
<span id="subsec-8.9.8"></span>
<div id="subsec-8.9.8" class="subsection">
<h3 class="subsectitle" id="example-bernoulli-polynomials-and-sums-of-powers">8.9.8 Example: Bernoulli Polynomials and Sums of Powers</h3>
<span id="ugxProblemSeriesBernoulli" class="label"></span>
<p>FriCAS provides operations for computing definite and <span class="index">summation:definite</span><span id="chapter-8-144"></span> indefinite sums. <span class="index">summation:indefinite</span><span id="chapter-8-145"></span></p>
You can compute the sum of the first ten fourth powers by evaluating this. This creates a list whose entries are
m4 as
m ranges from 1 to 10, and then computes the sum of the entries of that list.
<div id="spadComm8-177" class="spadComm">
<span id="commSav8-177" class="commSav">reduce(+,[m^4 for m in 1..10])</span>
<div id="mathAns8-177">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>25333</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: PositiveInteger
</div>
You can also compute a formula for the sum of the first
k fourth powers, where
k is an unspecified positive integer.
<div id="spadComm8-178" class="spadComm">
<span id="commSav8-178" class="commSav">sum4 := sum(m^4, m = 1..k) </span>
<div id="mathAns8-178">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>6k5+15k4+10k3-k30</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Fraction Polynomial Integer
</div>
This formula is valid for any positive integer
k. For instance, if we replace
k by 10, <span class="index">summation:definite</span><span id="chapter-8-146"></span> we obtain the number we computed earlier.
<div id="spadComm8-179" class="spadComm">
<span id="commSav8-179" class="commSav">eval(sum4, k = 10) </span>
<div id="mathAns8-179">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>25333</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Fraction Polynomial Integer
</div>
You can compute a formula for the sum of the first
k
n-th powers in a similar fashion. Just replace the
4 in the definition of <span style="font-weight: bold;"> sum4</span> by any expression not involving
k. FriCAS computes these formulas using Bernoulli polynomials; <span class="index">Bernoulli:polynomial</span><span id="chapter-8-147"></span> we <span class="index">polynomial:Bernoulli</span><span id="chapter-8-148"></span> use the rest of this section to describe this method.
First consider this function of
t and
x.
<div id="spadComm8-180" class="spadComm">
<span id="commSav8-180" class="commSav">f := t*exp(x*t) / (exp(t) - 1) </span>
<div id="mathAns8-180">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>te(tx)et-1</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Expression Integer
</div>
Since the expressions involved get quite large, we tell FriCAS to show us only terms of degree up to
5.
<div id="spadComm8-181" class="spadComm">
<span id="commSav8-181" class="commSav">)set streams calculate 5 </span>
<div id="mathAns8-181">

</div>
</div>
<p><span class="index">set streams calculate</span><span id="chapter-8-149"></span></p>
If we look at the Taylor expansion of
f(x,t) about
t=0, we see that the coefficients of the powers of
t are polynomials in
x.
<div id="spadComm8-182" class="spadComm">
<span id="commSav8-182" class="commSav">ff := taylor(f,t = 0) </span>
<div id="mathAns8-182">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1+2x-12t+6x2-6x+112t2+2x3-3x2+x12t3+30x4-60x3+30x2-1720t4+6x5-15x4+10x3-x720t5+O(t6)</td>
</tr>
</tbody>
</table>
</div>
<p>Type: UnivariateTaylorSeries(Expression Integer,t,0)</p>
In fact, the
n-th coefficient in this series is essentially the
n-th Bernoulli polynomial: the
n-th coefficient of the series is
1n!Bn(x), where
Bn(x) is the
n-th Bernoulli polynomial. Thus, to obtain the
n-th Bernoulli polynomial, we multiply the
n-th coefficient of the series
ff by
n!.
<p>For example, the sixth Bernoulli polynomial is this.</p>
<div id="spadComm8-183" class="spadComm">
<span id="commSav8-183" class="commSav">factorial(6) * coefficient(ff,6) </span>
<div id="mathAns8-183">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>42x6-126x5+105x4-21x2+142</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Expression Integer
</div>
We derive some properties of the function
f(x,t). First we compute
f(x+1,t)-f(x,t).
<div id="spadComm8-184" class="spadComm">
<span id="commSav8-184" class="commSav">g := eval(f, x = x + 1) - f </span>
<div id="mathAns8-184">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>te(tx+t)-te(tx)et-1</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Expression Integer
</div>
If we normalize
g, we see that it has a particularly simple form.
<div id="spadComm8-185" class="spadComm">
<span id="commSav8-185" class="commSav">normalize(g) </span>
<div id="mathAns8-185">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>te(tx)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Expression Integer
</div>
From this it follows that the
n-th coefficient in the Taylor expansion of
g(x,t) at
t=0 is
1(n-1)!xn-1.
<p>If you want to check this, evaluate the next expression.</p>
<div id="spadComm8-186" class="spadComm">
<span id="commSav8-186" class="commSav">taylor(g,t = 0) </span>
<div id="mathAns8-186">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>t+xt2+x22t3+x36t4+x424t5+O(t6)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: UnivariateTaylorSeries(Expression Integer,t,0)
</div>
However, since
g(x,t)=f(x+1,t)-f(x,t) it follows that the
n-th coefficient is
1n!(Bn(x+1)-Bn(x)) Equating coefficients, we see that
1(n-1)!xn-1=1n!(Bn(x+1)-Bn(x)) and, therefore,
xn-1=1n(Bn(x+1)-Bn(x))
Let's apply this formula repeatedly, letting
x vary between two integers
a and
b, with
a&lt;b:
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>an-1=1n(Bn(a+1)-Bn(a))(a+1)n-1=1n(Bn(a+2)-Bn(a+1))(a+2)n-1=1n(Bn(a+3)-Bn(a+2))⋮(b-1)n-1=1n(Bn(b)-Bn(b-1))bn-1=1n(Bn(b+1)-Bn(b))</td>
</tr>
</tbody>
</table>
</div>
When we add these equations we find that the sum of the left-hand sides is
the sum of the
(n-1)st powers from
a to
b. The sum of the right-hand sides is a <span class="italic">telescoping series.</span> After cancellation, the sum is simply
1n(Bn(b+1)-Bn(a))
Replacing
n by
n+1, we have shown that
∑m=abmn=1n+1(Bn+1(b+1)-Bn+1(a))
<p>Let's use this to obtain the formula for the sum of fourth powers.</p>
First we obtain the Bernoulli polynomial
B5.
<div id="spadComm8-187" class="spadComm">
<span id="commSav8-187" class="commSav">B5 := factorial(5) * coefficient(ff,5) </span>
<div id="mathAns8-187">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>6x5-15x4+10x3-x6</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Expression Integer
</div>
To find the sum of the first
k 4th powers, we multiply
1/5 by
B5(k+1)-B5(1).
<div id="spadComm8-188" class="spadComm">
<span id="commSav8-188" class="commSav">1/5 * (eval(B5, x = k + 1) - eval(B5, x = 1)) </span>
<div id="mathAns8-188">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>6k5+15k4+10k3-k30</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Expression Integer
</div>
This is the same formula that we obtained via
sum(m**4,m=1..k).
<div id="spadComm8-189" class="spadComm">
<span id="commSav8-189" class="commSav">sum4 </span>
<div id="mathAns8-189">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>6k5+15k4+10k3-k30</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Fraction Polynomial Integer
</div>
At this point you may want to do the same computation, but with an exponent other than
4. For example, you might try to find a formula for the sum of the first
k 20th powers.
</div>
</section>
<a href="book-contents.xhtml">Book Contents</a> <a href="section-8.8.xhtml">Previous Section 8.8 Integration</a><a href="section-8.10.xhtml">Next Section 8.10 Solution of Differential Equations</a> <a href="book-index.xhtml">Book Index</a>
</body>
</html>
