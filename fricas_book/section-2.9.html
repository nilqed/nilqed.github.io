<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Section2.9</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Section2.9</h1>
</header>
]&gt;
<a href="book-contents.xhtml">Book Contents</a><a href="section-2.8.xhtml">Previous Section 2.8 Subdomains Again</a><a href="section-2.10.xhtml">Next Section 2.10 Resolving Types</a> <a href="book-index.xhtml">Book Index</a>
<section id="sec-2.9">
<h2 class="sectiontitle" id="package-calling-and-target-types">2.9 Package Calling and Target Types</h2>
<span id="ugTypesPkgCall" class="label"></span>
<p>FriCAS works hard to figure out what you mean by an expression without your having to qualify it with type information. Nevertheless, there are times when you need to help it along by providing hints (or even orders!) to get FriCAS to do what you want.</p>
<p>We saw in <a href="section-2.3.xhtml#ugTypesDeclare" class="ref">ugTypesDeclare</a> that declarations using types and modes control the type of the results produced. For example, we can either produce a complex object with polynomial real and imaginary parts or a polynomial with complex integer coefficients, depending on the declaration.</p>
<p>Package calling is how you tell FriCAS to use a particular function from a particular part of the library.</p>
<p>Use the <span class="spadopFrom" title="Fraction">/</span> from <span class="teletype">Fraction Integer</span> to create a fraction of two integers.</p>
<div id="spadComm2-111" class="spadComm">
<span id="commSav2-111" class="commSav">2/3</span>
<div id="mathAns2-111">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>23</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Fraction Integer
</div>
<p>If we wanted a floating point number, we can say <span class="italic">use the <span class="spadopFrom" title="Float">/</span> in <span class="teletype">Float</span>.</span></p>
<div id="spadComm2-112" class="spadComm">
<span id="commSav2-112" class="commSav">(2/3) $Float</span>
<div id="mathAns2-112">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>0.66666666666666666667</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Float
</div>
<p>Perhaps we actually wanted a fraction of complex integers.</p>
<div id="spadComm2-113" class="spadComm">
<span id="commSav2-113" class="commSav">(2/3) $Fraction(Complex Integer)</span>
<div id="mathAns2-113">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>23</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Float
</div>
<p>In each case, AXIOM used the indicated operations, sometimes first needing to convert the two integers into objects of the appropriate type. In these examples, <span class="italic">/</span> is written as an infix operator.</p>
<div class="boxed2">
<div class="boxed">
To use package calling with an infix operator, use the following syntax:
(arg1 op arg2) $type
</div>
</div>
We used, for example,
(2/3) $Float. The expression
2+3+4 is equivalent to
(2+3)+4. Therefore in the expression
(2+3+4) $Float the second ``+'' comes from the Float domain. The first ``+'' comes from Float because the package call causes AXIOM to convert
(2+3) and
4 to type Float. Before the sum is converted, it is given a target type of Float by AXIOM and then evaluated. The target type causes the ``+'' from <span class="teletype">Float</span> to be used.
<div class="boxed2">
<div class="boxed">
For an operator written before its arguments, you must use parentheses around the arguments (even if there is only one), and follow the closing parenthesis by a `` $'' and then the type.
fun(arg1,arg2,…,argN) $type
</div>
</div>
<p>For example, to call the <span class="italic">minimum</span> function from SmallFloat on two integers, you could write <span style="font-weight: bold;"> min</span>(4,89) $<span class="teletype">SmallFloat</span>. Another use of package calling is to tell AXIOM to use a library function rather than a function you defined. We discuss this in Section <a href="section-6.9.xhtml#ugUserUse" class="ref">ugUserUse</a> .</p>
<p>Sometimes rather than specifying where an operation comes from, you just want to say what type the result should be. We say that you provide a <span style="font-style: italic;"> target type</span> for the expression. Instead of using a `` $'', use a ``@'' to specify the requested target type. Otherwise, the syntax is the same. Note that giving a target type is not the same as explicitly doing a conversion. The first says <span class="italic">try to pick operations so that the result has such-and-such a type.</span> The second says <span class="italic">compute the result and then convert to an object of such-and-such a type.</span></p>
<p>Sometimes it makes sense, as in this expression, to say ``choose the operations in this expression so that the final result is Float.</p>
<div id="spadComm2-114" class="spadComm">
<span id="commSav2-114" class="commSav">(2/3)@Float</span>
<div id="mathAns2-114">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>0.66666666666666666667</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Float
</div>
<p>Here we used ``<span class="teletype">@</span>'' to say that the target type of the left-hand side was <span class="teletype">Float</span>. In this simple case, there was no real difference between using ``<span class="teletype"> $</span>'' and ``<span class="teletype">@</span>''. You can see the difference if you try the following.</p>
<p>This says to try to choose ``<span class="teletype">+</span>'' so that the result is a string. FriCAS cannot do this.</p>
<div id="spadComm2-115" class="spadComm">
<span id="commSav2-115" class="commSav">(2 + 3)@String</span>
<div id="mathAns2-115">

</div>
</div>
<div class="verbatim">
 <br />
An expression involving @ String actually evaluated to one of <br />
   type PositiveInteger . Perhaps you should use :: String .<br />

</div>
<p>This says to get the <span class="teletype">+</span> from <span class="teletype">String</span> and apply it to the two integers. FriCAS also cannot do this because there is no <span class="teletype">+</span> exported by <span class="teletype">String</span>.</p>
<div id="spadComm2-116" class="spadComm">
<span id="commSav2-116" class="commSav">(2 + 3) $String</span>
<div id="mathAns2-116">

</div>
</div>
<div class="verbatim">
<br />
   The function + is not implemented in String .<br />

</div>
<p>(By the way, the operation <span class="spadfunFrom" style="font-weight: bold;">concat</span><span class="index">concat</span><span id="chapter-2-52"></span><span class="index">String</span><span id="chapter-2-53"></span> or juxtaposition is used to concatenate two strings.) <span class="index">String</span><span id="chapter-2-54"></span></p>
<p>When we have more than one operation in an expression, the difference is even more evident. The following two expressions show that FriCAS uses the target type to create different objects. The ``<span class="teletype">+</span>'', <span class="italic"><span class="teletype">*</span></span> and <span class="italic"><span class="teletype">^</span></span> operations are all chosen so that an object of the correct final type is created.</p>
<p>This says that the operations should be chosen so that the result is a <span class="teletype">Complex</span> object.</p>
<div id="spadComm2-117" class="spadComm">
<span id="commSav2-117" class="commSav">((x + y * %i)^2)@(Complex Polynomial Integer)</span>
<div id="mathAns2-117">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>-y2+x2+2xyi</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Complex Polynomial Integer
</div>
<p>This says that the operations should be chosen so that the result is a <span class="teletype">Polynomial</span> object.</p>
<div id="spadComm2-118" class="spadComm">
<span id="commSav2-118" class="commSav">((x + y * %i)^2)@(Polynomial Complex Integer)</span>
<div id="mathAns2-118">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>-y2+2ixy+x2</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Polynomial Complex Integer
</div>
<p>What do you think might happen if we left off all target type and package call information in this last example?</p>
<div id="spadComm2-119" class="spadComm">
<span id="commSav2-119" class="commSav">(x + y * %i)^2</span>
<div id="mathAns2-119">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>-y2+2ixy+x2</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Polynomial Complex Integer
</div>
<p>We can convert it to <span class="teletype">Complex</span> as an afterthought. But this is more work than just saying making what we want in the first place.</p>
<div id="spadComm2-120" class="spadComm">
<span id="commSav2-120" class="commSav">% :: Complex ?</span>
<div id="mathAns2-120">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>-y2+x2+2xyi</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Complex Polynomial Integer
</div>
<p>Finally, another use of package calling is to qualify fully an operation that is passed as an argument to a function.</p>
<p>Start with a small matrix of integers.</p>
<div id="spadComm2-121" class="spadComm">
<span id="commSav2-121" class="commSav">h := matrix [ [8,6],[-4,9] ]</span>
<div id="mathAns2-121">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[86-49]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Matrix Integer
</div>
We want to produce a new matrix that has for entries the multiplicative inverses of the entries of
h. One way to do this is by calling <span class="spadfunFrom" style="font-weight: bold;">map</span><span class="index">map</span><span id="chapter-2-55"></span><span class="index">MatrixCategoryFunctions2</span><span id="chapter-2-56"></span> with the <span class="spadfunFrom" style="font-weight: bold;">inv</span><span class="index">inv</span><span id="chapter-2-57"></span><span class="index">Fraction</span><span id="chapter-2-58"></span> function from <span class="teletype">Fraction (Integer)</span>.
<div id="spadComm2-122" class="spadComm">
<span id="commSav2-122" class="commSav">map(inv $Fraction(Integer),h)</span>
<div id="mathAns2-122">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[1816-1419]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Matrix Fraction Integer
</div>
<p>We could have been a bit less verbose and used abbreviations.</p>
<div id="spadComm2-123" class="spadComm">
<span id="commSav2-123" class="commSav">map(inv $FRAC(INT),h)</span>
<div id="mathAns2-123">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[1816-1419]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Matrix Fraction Integer
</div>
<p>As it turns out, FriCAS is smart enough to know what we mean anyway. We can just say this.</p>
<div id="spadComm2-124" class="spadComm">
<span id="commSav2-124" class="commSav">map(inv,h)</span>
<div id="mathAns2-124">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[1816-1419]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Matrix Fraction Integer
</div>
</section>
<a href="book-contents.xhtml">Book Contents</a> <a href="section-2.8.xhtml">Previous Section 2.8 Subdomains Again</a><a href="section-2.10.xhtml">Next Section 2.10 Resolving Types</a> <a href="book-index.xhtml">Book Index</a>
</body>
</html>
