<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Section9.2</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Section9.2</h1>
</header>
]&gt;
<a href="book-contents.xhtml">Book Contents</a><a href="section-9.1.xhtml">Previous Section 9.1 AssociationList</a><a href="section-9.3.xhtml">Next Section 9.3 BasicOperator</a> <a href="book-index.xhtml">Book Index</a>
<section id="sec-9.2">
<h2 class="sectiontitle" id="balancedbinarytree">9.2 BalancedBinaryTree</h2>
<span id="BalancedBinaryTreeXmpPage" class="label"></span>
<span class="teletype">BalancedBinaryTrees(S)</span> is the domain of balanced binary trees with elements of type <span class="teletype">S</span> at the nodes. A binary tree is either <span class="teletype">empty</span> or else consists of a <span class="teletype">node</span> having a <span class="teletype">value</span> and two branches, each branch a binary tree. A balanced binary tree is one that is balanced with respect its leaves. One with
2k leaves is perfectly <span class="italic">balanced</span>: the tree has minimum depth, and the <span class="teletype">left</span> and <span class="teletype">right</span> branch of every interior node is identical in shape.
<p>Balanced binary trees are useful in algebraic computation for so-called <span class="italic">divide-and-conquer</span> algorithms. Conceptually, the data for a problem is initially placed at the root of the tree. The original data is then split into two subproblems, one for each subtree. And so on. Eventually, the problem is solved at the leaves of the tree. A solution to the original problem is obtained by some mechanism that can reassemble the pieces. In fact, an implementation of the Chinese Remainder Algorithm using balanced binary trees was first proposed by David Y. Y. Yun at the IBM T. J. Watson Research Center in Yorktown Heights, New York, in 1978. It served as the prototype for polymorphic algorithms in FriCAS.</p>
In what follows, rather than perform a series of computations with a single expression, the expression is reduced modulo a number of integer primes, a computation is done with modular arithmetic for each prime, and the Chinese Remainder Algorithm is used to obtain the answer to the original problem. We illustrate this principle with the computation of
122=144.
<p>A list of moduli.</p>
<div id="spadComm9-11" class="spadComm">
<span id="commSav9-11" class="commSav">lm := [3,5,7,11]</span>
<div id="mathAns9-11">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[3,5,7,11]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: List PositiveInteger
</div>
<p>The expression <span class="teletype">modTree(n, lm)</span> creates a balanced binary tree with leaf values <span class="teletype">n mod m</span> for each modulus <span class="teletype">m</span> in <span class="teletype">lm</span>.</p>
<div id="spadComm9-12" class="spadComm">
<span id="commSav9-12" class="commSav">modTree(12,lm)</span>
<div id="mathAns9-12">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[0,2,5,1]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: List Integer
</div>
<p>Operation <span class="teletype">modTree</span> does this using operations on balanced binary trees. We trace its steps. Create a balanced binary tree <span class="teletype">t</span> of zeros with four leaves.</p>
<div id="spadComm9-13" class="spadComm">
<span id="commSav9-13" class="commSav">t := balancedBinaryTree( #lm, 0)</span>
<div id="mathAns9-13">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[[0,0,0],0,[0,0,0]]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: BalancedBinaryTree NonNegativeInteger
</div>
<p>The leaves of the tree are set to the individual moduli.</p>
<div id="spadComm9-14" class="spadComm">
<span id="commSav9-14" class="commSav">setleaves!(t,lm)</span>
<div id="mathAns9-14">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[[3,0,5],0,[7,0,11]]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: BalancedBinaryTree NonNegativeInteger
</div>
<p>Use <span class="teletype">mapUp!</span> to do a bottom-up traversal of <span class="teletype">t</span>, setting each interior node to the product of the values at the nodes of its children.</p>
<div id="spadComm9-15" class="spadComm">
<span id="commSav9-15" class="commSav">mapUp!(t,_*)</span>
<div id="mathAns9-15">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>1155</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: PositiveInteger
</div>
<p>The value at the node of every subtree is the product of the moduli of the leaves of the subtree.</p>
<div id="spadComm9-16" class="spadComm">
<span id="commSav9-16" class="commSav">t</span>
<div id="mathAns9-16">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[[3,15,5],1155,[7,77,11]]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: BalancedBinaryTree NonNegativeInteger
</div>
<p>Operation <span class="teletype">mapDown!</span><span class="teletype">(t,a,fn)</span> replaces the value <span class="teletype">v</span> at each node of <span class="teletype">t</span> by <span class="teletype">fn(a,v)</span>.</p>
<div id="spadComm9-17" class="spadComm">
<span id="commSav9-17" class="commSav">mapDown!(t,12,_rem)</span>
<div id="mathAns9-17">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[[0,12,2],12,[5,12,1]]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: BalancedBinaryTree NonNegativeInteger
</div>
<p>The operation <span class="teletype">leaves</span> returns the leaves of the resulting tree. In this case, it returns the list of <span class="teletype">12 mod m</span> for each modulus <span class="teletype">m</span>.</p>
<div id="spadComm9-18" class="spadComm">
<span id="commSav9-18" class="commSav">leaves %</span>
<div id="mathAns9-18">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[0,2,5,1]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: List NonNegativeInteger
</div>
<p>Compute the square of the images of <span class="teletype">12</span> modulo each <span class="teletype">m</span>.</p>
<div id="spadComm9-19" class="spadComm">
<span id="commSav9-19" class="commSav">squares := [x^2 rem m for x in % for m in lm]</span>
<div id="mathAns9-19">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>[0,4,4,1]</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: List NonNegativeInteger
</div>
Call the Chinese Remainder Algorithm to get the answer for
122.
<div id="spadComm9-20" class="spadComm">
<span id="commSav9-20" class="commSav">chineseRemainder(%,lm)</span>
<div id="mathAns9-20">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>144</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: PositiveInteger
</div>
</section>
<a href="book-contents.xhtml">Book Contents</a> <a href="section-9.1.xhtml">Previous Section 9.1 AssociationList</a><a href="section-9.3.xhtml">Next Section 9.3 BasicOperator</a> <a href="book-index.xhtml">Book Index</a>
</body>
</html>
