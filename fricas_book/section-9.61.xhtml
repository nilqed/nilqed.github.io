<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
"http://www.w3.org/TR/MathML2/dtd/xhtml-math11-f.dtd" [
<!ENTITY mathml "http://www.w3.org/1998/Math/MathML">
]>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:xlink="http://www.w3.org/1999/xlink" >


  <head>
    <title>Section9.61</title>
    <link rel="stylesheet" type="text/css" href="graphicstyle.css" />
    <script type="text/javascript" src="bookax1.js" />
  </head>

  <body>
<a href="book-contents.xhtml" style="margin-right: 10px;">Book Contents</a><a href="section-9.60.xhtml" style="margin-right: 10px;">Previous Section 9.60 OrderlyDifferentialPolynomial</a><a href="section-9.62.xhtml" style="margin-right: 10px;">Next Section 9.62 Permanent</a>
<a href="book-index.xhtml">Book Index</a><div class="section"  id="sec-9.61">
<h2 class="sectiontitle">9.61  PartialFraction</h2>


<a name="PartialFractionXmpPage" class="label"/>


<p>A <span class="italic">partial fraction</span> is a decomposition of a quotient into a sum
of quotients where the denominators of the summands are powers of
primes.<span class="footnote">Most people first encounter partial fractions when
they are learning integral calculus.  For a technical discussion of
partial fractions, see, for example, Lang's <span class="italic">Algebra.</span></span> For
example, the rational number <span class="teletype">1/6</span> is decomposed into <span class="teletype">1/2-1/3</span>.  
You can compute partial fractions of quotients of objects from
domains belonging to the category <span class="teletype">EuclideanDomain</span>.  For example,
<span class="teletype">Integer</span>, <span class="teletype">Complex Integer</span>, and 
<span class="teletype">UnivariatePolynomial(x, Fraction Integer)</span> 
all belong to <span class="teletype">EuclideanDomain</span>.  In the
examples following, we demonstrate how to decompose quotients of each
of these kinds of object into partial fractions.  Issue the system
command <span class="teletype">)show PartialFraction</span> to display the full list of
operations defined by <span class="teletype">PartialFraction</span>.
</p>


<p>It is necessary that we know how to factor the denominator when we
want to compute a partial fraction.  Although the interpreter can
often do this automatically, it may be necessary for you to include a
call to <span class="teletype">factor</span>.  In these examples, it is not necessary to
factor the denominators explicitly.
</p>


<p>The main operation for computing partial fractions is called
<span class="spadfunFrom" >partialFraction</span><span class="index">partialFraction</span><a name="chapter-9-24"/><span class="index">PartialFraction</span><a name="chapter-9-25"/> and we use this to
compute a decomposition of <span class="teletype">1 / 10!</span>.  The first argument to
<span class="spadfunFrom" >partialFraction</span><span class="index">partialFraction</span><a name="chapter-9-26"/><span class="index">PartialFraction</span><a name="chapter-9-27"/> is the numerator of the
quotient and the second argument is the factored denominator.
</p>




<div id="spadComm9-62" class="spadComm" >
<form id="formComm9-62" action="javascript:makeRequest('9-62');" >
<input id="comm9-62" type="text" class="command" style="width: 22em;" value="partialFraction(1,factorial 10) " />
</form>
<span id="commSav9-62" class="commSav" >partialFraction(1,factorial 10) </span>
<div id="mathAns9-62" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mfrac><mn>159</mn><mrow><msup><mn>2</mn><mn>8</mn></msup></mrow></mfrac><mo>-</mo><mfrac><mn>23</mn><mrow><msup><mn>3</mn><mn>4</mn></msup></mrow></mfrac><mo>-</mo><mfrac><mn>12</mn><mrow><msup><mn>5</mn><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>7</mn></mfrac></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: PartialFraction Integer
</div>



<p>Since the denominators are powers of primes, it may be possible
to expand the numerators further with respect to those primes. Use the
operation <span class="spadfunFrom" >padicFraction</span><span class="index">padicFraction</span><a name="chapter-9-28"/><span class="index">PartialFraction</span><a name="chapter-9-29"/> to do this.
</p>




<div id="spadComm9-63" class="spadComm" >
<form id="formComm9-63" action="javascript:makeRequest('9-63');" >
<input id="comm9-63" type="text" class="command" style="width: 16em;" value="f := padicFraction(%) " />
</form>
<span id="commSav9-63" class="commSav" >f := padicFraction(%) </span>
<div id="mathAns9-63" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><msup><mn>2</mn><mn>4</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><msup><mn>2</mn><mn>5</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><msup><mn>2</mn><mn>6</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><msup><mn>2</mn><mn>7</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><msup><mn>2</mn><mn>8</mn></msup></mrow></mfrac><mo>-</mo><mfrac><mn>2</mn><mrow><msup><mn>3</mn><mn>2</mn></msup></mrow></mfrac><mo>-</mo><mfrac><mn>1</mn><mrow><msup><mn>3</mn><mn>3</mn></msup></mrow></mfrac><mo>-</mo><mfrac><mn>2</mn><mrow><msup><mn>3</mn><mn>4</mn></msup></mrow></mfrac><mo>-</mo><mfrac><mn>2</mn><mn>5</mn></mfrac><mo>-</mo><mfrac><mn>2</mn><mrow><msup><mn>5</mn><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>7</mn></mfrac></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: PartialFraction Integer
</div>



<p>The operation <span class="spadfunFrom" >compactFraction</span><span class="index">compactFraction</span><a name="chapter-9-30"/><span class="index">PartialFraction</span><a name="chapter-9-31"/> returns
an expanded fraction into the usual form.  The compacted version is
used internally for computational efficiency.
</p>




<div id="spadComm9-64" class="spadComm" >
<form id="formComm9-64" action="javascript:makeRequest('9-64');" >
<input id="comm9-64" type="text" class="command" style="width: 13em;" value="compactFraction(f) " />
</form>
<span id="commSav9-64" class="commSav" >compactFraction(f) </span>
<div id="mathAns9-64" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mfrac><mn>159</mn><mrow><msup><mn>2</mn><mn>8</mn></msup></mrow></mfrac><mo>-</mo><mfrac><mn>23</mn><mrow><msup><mn>3</mn><mn>4</mn></msup></mrow></mfrac><mo>-</mo><mfrac><mn>12</mn><mrow><msup><mn>5</mn><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>7</mn></mfrac></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: PartialFraction Integer
</div>



<p>You can add, subtract, multiply and divide partial fractions.  In
addition, you can extract the parts of the decomposition.
<span class="spadfunFrom" >numberOfFractionalTerms</span><span class="index">numberOfFractionalTerms</span><a name="chapter-9-32"/><span class="index">PartialFraction</span><a name="chapter-9-33"/> computes the
number of terms in the fractional part.  This does not include the
whole part of the fraction, which you get by calling
<span class="spadfunFrom" >wholePart</span><span class="index">wholePart</span><a name="chapter-9-34"/><span class="index">PartialFraction</span><a name="chapter-9-35"/>.  In this example, the whole
part is just <span class="teletype">0</span>.
</p>




<div id="spadComm9-65" class="spadComm" >
<form id="formComm9-65" action="javascript:makeRequest('9-65');" >
<input id="comm9-65" type="text" class="command" style="width: 18em;" value="numberOfFractionalTerms(f) " />
</form>
<span id="commSav9-65" class="commSav" >numberOfFractionalTerms(f) </span>
<div id="mathAns9-65" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mn>12</mn></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: PositiveInteger
</div>



<p>The operation <span class="spadfunFrom" >nthFractionalTerm</span><span class="index">nthFractionalTerm</span><a name="chapter-9-36"/><span class="index">PartialFraction</span><a name="chapter-9-37"/> returns
the individual terms in the decomposition.  Notice that the object
returned is a partial fraction itself.
<span class="spadfunFrom" >firstNumer</span><span class="index">firstNumer</span><a name="chapter-9-38"/><span class="index">PartialFraction</span><a name="chapter-9-39"/> and
<span class="spadfunFrom" >firstDenom</span><span class="index">firstDenom</span><a name="chapter-9-40"/><span class="index">PartialFraction</span><a name="chapter-9-41"/> extract the numerator and
denominator of the first term of the fraction.
</p>




<div id="spadComm9-66" class="spadComm" >
<form id="formComm9-66" action="javascript:makeRequest('9-66');" >
<input id="comm9-66" type="text" class="command" style="width: 16em;" value="nthFractionalTerm(f,3) " />
</form>
<span id="commSav9-66" class="commSav" >nthFractionalTerm(f,3) </span>
<div id="mathAns9-66" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mfrac><mn>1</mn><mrow><msup><mn>2</mn><mn>5</mn></msup></mrow></mfrac></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: PartialFraction Integer
</div>



<p>Given two gaussian integers (see 
<a href="section-9.11.xhtml#ComplexXmpPage" class="ref" >ComplexXmpPage</a> ), you can
decompose their quotient into a partial fraction.
</p>




<div id="spadComm9-67" class="spadComm" >
<form id="formComm9-67" action="javascript:makeRequest('9-67');" >
<input id="comm9-67" type="text" class="command" style="width: 24em;" value="partialFraction(1,- 13 + 14 * %i) " />
</form>
<span id="commSav9-67" class="commSav" >partialFraction(1,- 13 + 14 * %i) </span>
<div id="mathAns9-67" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>-</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mrow><mn>2</mn><mspace width="0.5 em" /><mi>i</mi></mrow></mrow></mfrac><mo>+</mo><mfrac><mn>4</mn><mrow><mn>3</mn><mo>+</mo><mrow><mn>8</mn><mspace width="0.5 em" /><mi>i</mi></mrow></mrow></mfrac></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: PartialFraction Complex Integer
</div>



<p>To convert back to a quotient, simply use a conversion.
</p>




<div id="spadComm9-68" class="spadComm" >
<form id="formComm9-68" action="javascript:makeRequest('9-68');" >
<input id="comm9-68" type="text" class="command" style="width: 21em;" value="% :: Fraction Complex Integer " />
</form>
<span id="commSav9-68" class="commSav" >% :: Fraction Complex Integer </span>
<div id="mathAns9-68" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>-</mo><mfrac><mi>i</mi><mrow><mn>14</mn><mo>+</mo><mrow><mn>13</mn><mspace width="0.5 em" /><mi>i</mi></mrow></mrow></mfrac></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Fraction Complex Integer
</div>



<p>To conclude this section, we compute the decomposition of
</p>



<div class="verbatim"><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(x&nbsp;+&nbsp;1)(x&nbsp;+&nbsp;2)&nbsp;(x&nbsp;+&nbsp;3)&nbsp;(x&nbsp;+&nbsp;4)<br />
</div>



<p>The polynomials in this object have type
<span class="teletype">UnivariatePolynomial(x, Fraction Integer)</span>.
</p>


<p>We use the <span class="spadfunFrom" >primeFactor</span><span class="index">primeFactor</span><a name="chapter-9-42"/><span class="index">Factored</span><a name="chapter-9-43"/> operation (see
<a href="section-9.22.xhtml#FactoredXmpPage" class="ref" >FactoredXmpPage</a> ) 
to create the denominator in factored form directly.
</p>




<div id="spadComm9-69" class="spadComm" >
<form id="formComm9-69" action="javascript:makeRequest('9-69');" >
<input id="comm9-69" type="text" class="command" style="width: 48em;" value="u : FR UP(x, FRAC INT) := reduce(*,[primeFactor(x+i,i) for i in 1..4]) " />
</form>
<span id="commSav9-69" class="commSav" >u : FR UP(x, FRAC INT) := reduce(*,[primeFactor(x+i,i) for i in 1..4]) </span>
<div id="mathAns9-69" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo>)</mo></mrow><mspace width="0.5 em" /><mrow><msup><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mn>2</mn><mo>)</mo></mrow><mn>2</mn></msup></mrow><mspace width="0.5 em" /><mrow><msup><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mn>3</mn><mo>)</mo></mrow><mn>3</mn></msup></mrow><mspace width="0.5 em" /><mrow><msup><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mn>4</mn><mo>)</mo></mrow><mn>4</mn></msup></mrow></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Factored UnivariatePolynomial(x,Fraction Integer)
</div>



<p>These are the compact and expanded partial fractions for the quotient.
</p>




<div id="spadComm9-70" class="spadComm" >
<form id="formComm9-70" action="javascript:makeRequest('9-70');" >
<input id="comm9-70" type="text" class="command" style="width: 14em;" value="partialFraction(1,u) " />
</form>
<span id="commSav9-70" class="commSav" >partialFraction(1,u) </span>
<div id="mathAns9-70" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mtable><mtr><mtd><mfrac><mfrac><mn>1</mn><mn>648</mn></mfrac><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mo>+</mo><mfrac><mrow><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac><mspace width="0.5 em" /><mi>x</mi></mrow><mo>+</mo><mfrac><mn>7</mn><mn>16</mn></mfrac></mrow><mrow><msup><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mn>2</mn><mo>)</mo></mrow><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>-</mo><mrow><mfrac><mn>17</mn><mn>8</mn></mfrac><mspace width="0.5 em" /><mrow><msup><mi>x</mi><mn>2</mn></msup></mrow></mrow><mo>-</mo><mrow><mn>12</mn><mspace width="0.5 em" /><mi>x</mi></mrow><mo>-</mo><mfrac><mn>139</mn><mn>8</mn></mfrac></mrow><mrow><msup><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mn>3</mn><mo>)</mo></mrow><mn>3</mn></msup></mrow></mfrac><mo>+</mo></mtd></mtr><mtr><mtd></mtd></mtr><mtr><mtd><mfrac><mrow><mrow><mfrac><mn>607</mn><mn>324</mn></mfrac><mspace width="0.5 em" /><mrow><msup><mi>x</mi><mn>3</mn></msup></mrow></mrow><mo>+</mo><mrow><mfrac><mn>10115</mn><mn>432</mn></mfrac><mspace width="0.5 em" /><mrow><msup><mi>x</mi><mn>2</mn></msup></mrow></mrow><mo>+</mo><mrow><mfrac><mn>391</mn><mn>4</mn></mfrac><mspace width="0.5 em" /><mi>x</mi></mrow><mo>+</mo><mfrac><mn>44179</mn><mn>324</mn></mfrac></mrow><mrow><msup><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mn>4</mn><mo>)</mo></mrow><mn>4</mn></msup></mrow></mfrac></mtd></mtr></mtable></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: PartialFraction UnivariatePolynomial(x,Fraction Integer)
</div>





<div id="spadComm9-71" class="spadComm" >
<form id="formComm9-71" action="javascript:makeRequest('9-71');" >
<input id="comm9-71" type="text" class="command" style="width: 12em;" value="padicFraction % " />
</form>
<span id="commSav9-71" class="commSav" >padicFraction % </span>
<div id="mathAns9-71" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mtable><mtr><mtd><mfrac><mfrac><mn>1</mn><mn>648</mn></mfrac><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mo>+</mo><mfrac><mfrac><mn>1</mn><mn>4</mn></mfrac><mrow><mi>x</mi><mo>+</mo><mn>2</mn></mrow></mfrac><mo>-</mo><mfrac><mfrac><mn>1</mn><mn>16</mn></mfrac><mrow><msup><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mn>2</mn><mo>)</mo></mrow><mn>2</mn></msup></mrow></mfrac><mo>-</mo><mfrac><mfrac><mn>17</mn><mn>8</mn></mfrac><mrow><mi>x</mi><mo>+</mo><mn>3</mn></mrow></mfrac><mo>+</mo><mfrac><mfrac><mn>3</mn><mn>4</mn></mfrac><mrow><msup><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mn>3</mn><mo>)</mo></mrow><mn>2</mn></msup></mrow></mfrac><mo>-</mo><mfrac><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><msup><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mn>3</mn><mo>)</mo></mrow><mn>3</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mfrac><mn>607</mn><mn>324</mn></mfrac><mrow><mi>x</mi><mo>+</mo><mn>4</mn></mrow></mfrac><mo>+</mo></mtd></mtr><mtr><mtd></mtd></mtr><mtr><mtd><mfrac><mfrac><mn>403</mn><mn>432</mn></mfrac><mrow><msup><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mn>4</mn><mo>)</mo></mrow><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mfrac><mn>13</mn><mn>36</mn></mfrac><mrow><msup><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mn>4</mn><mo>)</mo></mrow><mn>3</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mfrac><mn>1</mn><mn>12</mn></mfrac><mrow><msup><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mn>4</mn><mo>)</mo></mrow><mn>4</mn></msup></mrow></mfrac></mtd></mtr></mtable></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: PartialFraction UnivariatePolynomial(x,Fraction Integer)
</div>



<p>All see <a href="section-9.29.xhtml#FullPartialFractionExpansionXmpPage" class="ref" >FullPartialFractionExpansionXmpPage</a>  for examples of
factor-free conversion of quotients to full partial fractions.
</p>




</div><a href="book-contents.xhtml" style="margin-right: 10px;">Book Contents</a>
<a href="section-9.60.xhtml" style="margin-right: 10px;">Previous Section 9.60 OrderlyDifferentialPolynomial</a><a href="section-9.62.xhtml" style="margin-right: 10px;">Next Section 9.62 Permanent</a>
<a href="book-index.xhtml">Book Index</a></body>
</html>