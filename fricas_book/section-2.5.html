<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Section2.5</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Section2.5</h1>
</header>
]&gt;
<a href="book-contents.xhtml">Book Contents</a><a href="section-2.4.xhtml">Previous Section 2.4 Records</a><a href="section-2.6.xhtml">Next Section 2.6 The <span class="italic">Any</span> Domain</a> <a href="book-index.xhtml">Book Index</a>
<section id="sec-2.5">
<h2 class="sectiontitle" id="unions">2.5 Unions</h2>
<span id="ugTypesUnions" class="label"></span>
<p>Type <span class="teletype">Union</span> is used for objects that can be of any of a specific finite set of types. <span class="index">Union</span><span id="chapter-2-31"></span> Two versions of unions are available, one with selectors (like records) and one without. <span class="index">union</span><span id="chapter-2-32"></span></p>
<span id="subsec-2.5.1"></span>
<div id="subsec-2.5.1" class="subsection">
<h3 class="subsectitle" id="unions-without-selectors">2.5.1 Unions Without Selectors</h3>
<span id="ugTypesUnionsWOSel" class="label"></span>
The declaration
x:Union(Integer,String,Float) states that
x can have values that are integers, strings or <span class="italic">big</span> floats. If, for example, the <span class="teletype">Union</span> object is an integer, the object is said to belong to the <span class="teletype">Integer</span> <span class="italic">branch</span> of the <span class="teletype">Union</span>. Note that we are being a bit careless with the language here. Technically, the type of
x is always <span class="teletype">Union(Integer, String, Float)</span>. If it belongs to the <span class="teletype">Integer</span> branch,
x may be converted to an object of type <span class="teletype">Integer</span>.
<div class="boxed2">
<div class="boxed">
<p>The syntax for writing a <span class="teletype">Union</span> type without selectors is</p>
<div class="center" style="text-align: center;">
Union(
type1,
type2, ...,
typeN)
</div>
<p>The types in a union without selectors must be distinct.<br />
</p>
</div>
</div>
<p>It is possible to create unions like <span class="teletype">Union(Integer, PositiveInteger)</span> but they are difficult to work with because of the overlap in the branch types. See below for the rules FriCAS uses for converting something into a union object.</p>
<p>The <span class="teletype">case</span> infix <span class="index">case</span><span id="chapter-2-33"></span> operator returns a <span class="teletype">Boolean</span> and can be used to determine the branch in which an object lies.</p>
This function displays a message stating in which branch of the <span class="teletype">Union</span> the object (defined as
x above) lies.
<div class="verbatim">
<br />
sayBranch(x : Union(Integer,String,Float)) : Void  ==<br />
  output<br />
    x case Integer =&gt; "Integer branch"<br />
    x case String  =&gt; "String branch"<br />
    "Float branch"<br />

</div>
<p>This tries <span style="font-weight: bold;"> sayBranch</span> with an integer.</p>
<div id="spadComm2-64" class="spadComm">
<span id="commSav2-64" class="commSav">sayBranch 1</span>
<div id="mathAns2-64">

</div>
</div>
<div class="verbatim">
<br />
Compiling function sayBranch with type Union(Integer,String,Float)<br />
    -&gt; Void <br />
 Integer branch<br />

</div>
<div class="returnType">
Type: Void
</div>
<p>This tries <span style="font-weight: bold;"> sayBranch</span> with a string.</p>
<div id="spadComm2-65" class="spadComm">
<span id="commSav2-65" class="commSav">sayBranch "hello"</span>
<div id="mathAns2-65">

</div>
</div>
<div class="verbatim">
<br />
   String branch<br />

</div>
<div class="returnType">
Type: Void
</div>
<p>This tries <span style="font-weight: bold;"> sayBranch</span> with a floating-point number.</p>
<div id="spadComm2-66" class="spadComm">
<span id="commSav2-66" class="commSav">sayBranch 2.718281828</span>
<div id="mathAns2-66">

</div>
</div>
<div class="verbatim">
<br />
   Float branch<br />

</div>
<div class="returnType">
Type: Void
</div>
<p>There are two things of interest about this particular example to which we would like to draw your attention.</p>
<ol>
<li>FriCAS normally converts a result to the target value before passing it to the function. If we left the declaration information out of this function definition then the <span style="font-weight: bold;"> sayBranch</span> call would have been attempted with an <span class="teletype">Integer</span> rather than a <span class="teletype">Union</span>, and an error would have resulted.</li>
<li>The types in a <span class="teletype">Union</span> are searched in the order given. So if the type were given as <span class="teletype">sayBranch(x: Union(String,Integer,Float,Any)): Void</span> then the result would have been <span class="italic">String branch</span> because there is a conversion from <span class="teletype">Integer</span> to <span class="teletype">String</span>.</li>
</ol>
<p>Sometimes <span class="teletype">Union</span> types can have extremely long names. FriCAS therefore abbreviates the names of unions by printing the type of the branch first within the <span class="teletype">Union</span> and then eliding the remaining types with an ellipsis (<span class="teletype">...</span>).</p>
<p>Here the <span class="teletype">Integer</span> branch is displayed first. Use ``<span class="teletype">::</span>'' to create a <span class="teletype">Union</span> object from an object.</p>
<div id="spadComm2-67" class="spadComm">
<span id="commSav2-67" class="commSav">78 :: Union(Integer,String)</span>
<div id="mathAns2-67">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>78</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Union(Integer,...)
</div>
<p>Here the <span class="teletype">String</span> branch is displayed first.</p>
<div id="spadComm2-68" class="spadComm">
<span id="commSav2-68" class="commSav">s := "string" :: Union(Integer,String)</span>
<div id="mathAns2-68">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>"string"</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Union(String,...)
</div>
<p>Use <span class="teletype">typeOf</span> to see the full and actual <span class="teletype">Union</span> type. <span class="index">typeOf</span><span id="chapter-2-34"></span></p>
<div id="spadComm2-69" class="spadComm">
<span id="commSav2-69" class="commSav">typeOf s</span>
<div id="mathAns2-69">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>Union(Integer,String)</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Domain
</div>
<p>A common operation that returns a union is <span class="spadfunFrom" style="font-weight: bold;">exquo</span><span class="index">exquo</span><span id="chapter-2-35"></span><span class="index">Integer</span><span id="chapter-2-36"></span> which returns the <span class="italic">exact quotient</span> if the quotient is exact,</p>
<div id="spadComm2-70" class="spadComm">
<span id="commSav2-70" class="commSav">three := exquo(6,2)</span>
<div id="mathAns2-70">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>3</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Union(Integer,...)
</div>
<p>and <span class="teletype">"failed"</span> if the quotient is not exact.</p>
<div id="spadComm2-71" class="spadComm">
<span id="commSav2-71" class="commSav">exquo(5,2)</span>
<div id="mathAns2-71">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>"failed"</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Union("failed",...)
</div>
A union with a <span class="teletype">"failed"</span> is frequently used to indicate the failure or lack of applicability of an object. As another example, assign an integer a variable
r declared to be a rational number.
<div id="spadComm2-72" class="spadComm">
<span id="commSav2-72" class="commSav">r: FRAC INT := 3</span>
<div id="mathAns2-72">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>3</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Fraction Integer
</div>
<p>The operation <span class="spadfunFrom" style="font-weight: bold;">retractIfCan</span><span class="index">retractIfCan</span><span id="chapter-2-37"></span><span class="index">Fraction</span><span id="chapter-2-38"></span> tries to retract the fraction to the underlying domain <span class="teletype">Integer</span>. It produces a union object. Here it succeeds.</p>
<div id="spadComm2-73" class="spadComm">
<span id="commSav2-73" class="commSav">retractIfCan(r)</span>
<div id="mathAns2-73">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>3</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Union(Integer,...)
</div>
<p>Assign it a rational number.</p>
<div id="spadComm2-74" class="spadComm">
<span id="commSav2-74" class="commSav">r := 3/2</span>
<div id="mathAns2-74">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>32</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Fraction Integer
</div>
<p>Here the retraction fails.</p>
<div id="spadComm2-75" class="spadComm">
<span id="commSav2-75" class="commSav">retractIfCan(r)</span>
<div id="mathAns2-75">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>"failed"</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Union("failed",...)
</div>
</div>
<span id="subsec-2.5.2"></span>
<div id="subsec-2.5.2" class="subsection">
<h3 class="subsectitle" id="unions-with-selectors">2.5.2 Unions With Selectors</h3>
<span id="ugTypesUnionsWSel" class="label"></span>
<p>Like records (<a href="section-2.4.xhtml#ugTypesRecords" class="ref">ugTypesRecords</a> ), you can write <span class="teletype">Union</span> types <span class="index">selector:union</span><span id="chapter-2-39"></span> with selectors. <span class="index">union:selector</span><span id="chapter-2-40"></span></p>
<div class="boxed2">
<div class="boxed">
<p>The syntax for writing a <span class="teletype">Union</span> type with selectors is</p>
<div class="center" style="text-align: center;">
Union(
selector1:
type1,
selector2:
type2, ...,
selectorN:
typeN)
</div>
<p>You must be careful if a selector has the same name as a variable in the workspace. If this occurs, precede the selector name by a single <span class="index">quote</span><span id="chapter-2-41"></span> quote. <span class="index">selector:quoting</span><span id="chapter-2-42"></span> It is an error to use a selector that does not correspond to the branch of the <span class="teletype">Union</span> in which the element actually lies.<br />
</p>
</div>
</div>
<p>Be sure to understand the difference between records and unions with selectors. <span class="index">union:difference from record</span><span id="chapter-2-43"></span> Records can have more than one component and the selectors are used to refer to the components. <span class="index">record:difference from union</span><span id="chapter-2-44"></span> Unions always have one component but the type of that one component can vary. An object of type <span class="teletype">Record(a: Integer, b: Float, c: String)</span> contains an integer <span class="italic">and</span> a float <span class="italic">and</span> a string. An object of type <span class="teletype">Union(a: Integer, b: Float, c: String)</span> contains an integer <span class="italic">or</span> a float <span class="italic">or</span> a string.</p>
<p>Here is a version of the <span style="font-weight: bold;"> sayBranch</span> function (cf. <a href="section-2.5.xhtml#ugTypesUnionsWOSel" class="ref">ugTypesUnionsWOSel</a> ) that works with a union with selectors. It displays a message stating in which branch of the <span class="teletype">Union</span> the object lies.</p>
<div class="verbatim">
<br />
sayBranch(x:Union(i:Integer,s:String,f:Float)):Void==<br />
  output<br />
    x case i =&gt; "Integer branch"<br />
    x case s  =&gt; "String branch"<br />
    "Float branch"<br />

</div>
<p>Note that <span class="teletype">case</span> uses the selector name as its right-hand argument. <span class="index">case</span><span id="chapter-2-45"></span> If you accidentally use the branch type on the right-hand side of <span class="teletype">case</span>, <span class="teletype">false</span> will be returned.</p>
Declare variable
u to have a union type with selectors.
<div id="spadComm2-76" class="spadComm">
<span id="commSav2-76" class="commSav">u : Union(i : Integer, s : String)</span>
<div id="mathAns2-76">

</div>
</div>
<div class="returnType">
Type: Void
</div>
Give an initial value to
u.
<div id="spadComm2-77" class="spadComm">
<span id="commSav2-77" class="commSav">u := "good morning"</span>
<div id="mathAns2-77">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>"goodmorning"</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Union(s: String,...)
</div>
Use
case to determine in which branch of a <span class="teletype">Union</span> an object lies.
<div id="spadComm2-78" class="spadComm">
<span id="commSav2-78" class="commSav">u case i</span>
<div id="mathAns2-78">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>false</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Boolean
</div>
<div id="spadComm2-79" class="spadComm">
<span id="commSav2-79" class="commSav">u case s</span>
<div id="mathAns2-79">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>true</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: Boolean
</div>
<p>To access the element in a particular branch, use the selector.</p>
<div id="spadComm2-80" class="spadComm">
<span id="commSav2-80" class="commSav">u.s</span>
<div id="mathAns2-80">

</div>
</div>
<div class="math">
<table>
<tbody>
<tr class="odd">
<td>"goodmorning"</td>
</tr>
</tbody>
</table>
</div>
<div class="returnType">
Type: String
</div>
</div>
</section>
<a href="book-contents.xhtml">Book Contents</a> <a href="section-2.4.xhtml">Previous Section 2.4 Records</a><a href="section-2.6.xhtml">Next Section 2.6 The <span class="italic">Any</span> Domain</a> <a href="book-index.xhtml">Book Index</a>
</body>
</html>
